<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: Sequel::Plugins::HookClassMethods::ClassMethods</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">Sequel::Plugins::HookClassMethods::ClassMethods</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../../files/lib/sequel/plugins/hook_class_methods_rb.html">
                lib/sequel/plugins/hook_class_methods.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000126">add_hook_type</a>&nbsp;&nbsp;
      <a href="#M000127">has_hooks?</a>&nbsp;&nbsp;
      <a href="#M000128">hook_blocks</a>&nbsp;&nbsp;
      <a href="#M000129">inherited</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000126" class="method-detail">
        <a name="M000126"></a>

        <div class="method-heading">
          <a href="#M000126" class="method-signature">
          <span class="method-name">add_hook_type</span><span class="method-args">(*hooks)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This adds a new hook type. It will define both a class method that you can
use to add hooks, as well as an instance method that you can use to call
all hooks of that type. The class method can be called with a symbol or a
block or both. If a block is given and and symbol is not, it adds the hook
block to the hook type. If a block and symbol are both given, it replaces
the hook block associated with that symbol for a given hook type, or adds
it if there is no hook block with that symbol for that hook type. If no
block is given, it assumes the symbol specifies an instance method to call
and adds it to the hook type.
</p>
<p>
If any hook block returns false, the instance method will return false
immediately without running the rest of the hooks of that type.
</p>
<p>
It is recommended that you always provide a symbol to this method, for
descriptive purposes. It&#8216;s only necessary to do so when you are using
a system that reloads code.
</p>
<p>
Example of usage:
</p>
<pre>
 class MyModel
  define_hook :before_move_to
  before_move_to(:check_move_allowed){|o| o.allow_move?}
  def move_to(there)
    return if before_move_to == false
    # move MyModel object to there
  end
 end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000126-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000126-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/plugins/hook_class_methods.rb, line 60</span>
60:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_hook_type</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">hooks</span>)
61:           <span class="ruby-constant">Model</span><span class="ruby-operator">::</span><span class="ruby-constant">HOOKS</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">hooks</span>)
62:           <span class="ruby-identifier">hooks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hook</span><span class="ruby-operator">|</span>
63:             <span class="ruby-ivar">@hooks</span>[<span class="ruby-identifier">hook</span>] = []
64:             <span class="ruby-identifier">instance_eval</span>(<span class="ruby-node">&quot;def #{hook}(method = nil, &amp;block); add_hook(:#{hook}, method, &amp;block) end&quot;</span>, <span class="ruby-keyword kw">__FILE__</span>, <span class="ruby-keyword kw">__LINE__</span>)
65:             <span class="ruby-identifier">class_eval</span>(<span class="ruby-node">&quot;def #{hook}; run_hooks(:#{hook}); end&quot;</span>, <span class="ruby-keyword kw">__FILE__</span>, <span class="ruby-keyword kw">__LINE__</span>)
66:           <span class="ruby-keyword kw">end</span>
67:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000127" class="method-detail">
        <a name="M000127"></a>

        <div class="method-heading">
          <a href="#M000127" class="method-signature">
          <span class="method-name">has_hooks?</span><span class="method-args">(hook)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if there are any hook blocks for the given hook.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000127-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000127-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/plugins/hook_class_methods.rb, line 70</span>
70:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">has_hooks?</span>(<span class="ruby-identifier">hook</span>)
71:           <span class="ruby-operator">!</span><span class="ruby-ivar">@hooks</span>[<span class="ruby-identifier">hook</span>].<span class="ruby-identifier">empty?</span>
72:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000128" class="method-detail">
        <a name="M000128"></a>

        <div class="method-heading">
          <a href="#M000128" class="method-signature">
          <span class="method-name">hook_blocks</span><span class="method-args">(hook) {|v| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Yield every block related to the given hook.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000128-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000128-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/plugins/hook_class_methods.rb, line 75</span>
75:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">hook_blocks</span>(<span class="ruby-identifier">hook</span>)
76:           <span class="ruby-ivar">@hooks</span>[<span class="ruby-identifier">hook</span>].<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">v</span>}
77:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000129" class="method-detail">
        <a name="M000129"></a>

        <div class="method-heading">
          <a href="#M000129" class="method-signature">
          <span class="method-name">inherited</span><span class="method-args">(subclass)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Make a copy of the current class&#8216;s hooks for the subclass.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000129-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000129-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/plugins/hook_class_methods.rb, line 80</span>
80:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inherited</span>(<span class="ruby-identifier">subclass</span>)
81:           <span class="ruby-keyword kw">super</span>
82:           <span class="ruby-identifier">hooks</span> = <span class="ruby-identifier">subclass</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">:@hooks</span>, {}) 
83:           <span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-identifier">:@hooks</span>).<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">hooks</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span>.<span class="ruby-identifier">dup</span>}
84:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>