<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: Sequel::Plugins::ValidationClassMethods::ClassMethods</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">Sequel::Plugins::ValidationClassMethods::ClassMethods</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../../files/lib/sequel/plugins/validation_class_methods_rb.html">
                lib/sequel/plugins/validation_class_methods.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000088">has_validations?</a>&nbsp;&nbsp;
      <a href="#M000089">skip_superclass_validations</a>&nbsp;&nbsp;
      <a href="#M000090">skip_superclass_validations?</a>&nbsp;&nbsp;
      <a href="#M000092">validate</a>&nbsp;&nbsp;
      <a href="#M000091">validates</a>&nbsp;&nbsp;
      <a href="#M000093">validates_acceptance_of</a>&nbsp;&nbsp;
      <a href="#M000094">validates_confirmation_of</a>&nbsp;&nbsp;
      <a href="#M000095">validates_each</a>&nbsp;&nbsp;
      <a href="#M000096">validates_format_of</a>&nbsp;&nbsp;
      <a href="#M000101">validates_inclusion_of</a>&nbsp;&nbsp;
      <a href="#M000097">validates_length_of</a>&nbsp;&nbsp;
      <a href="#M000098">validates_not_string</a>&nbsp;&nbsp;
      <a href="#M000099">validates_numericality_of</a>&nbsp;&nbsp;
      <a href="#M000100">validates_presence_of</a>&nbsp;&nbsp;
      <a href="#M000102">validates_uniqueness_of</a>&nbsp;&nbsp;
      <a href="#M000103">validations</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Class <a href="ClassMethods/Generator.html" class="link">Sequel::Plugins::ValidationClassMethods::ClassMethods::Generator</a><br />

    </div>




      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000088" class="method-detail">
        <a name="M000088"></a>

        <div class="method-heading">
          <a href="#M000088" class="method-signature">
          <span class="method-name">has_validations?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if <a href="ClassMethods.html#M000103">validations</a> are
defined.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000088-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000088-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 23</span>
23:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">has_validations?</span>
24:           <span class="ruby-operator">!</span><span class="ruby-identifier">validations</span>.<span class="ruby-identifier">empty?</span>
25:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000089" class="method-detail">
        <a name="M000089"></a>

        <div class="method-heading">
          <a href="#M000089" class="method-signature">
          <span class="method-name">skip_superclass_validations</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Instructs the model to skip <a
href="ClassMethods.html#M000103">validations</a> defined in superclasses
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000089-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000089-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 28</span>
28:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">skip_superclass_validations</span>
29:           <span class="ruby-ivar">@skip_superclass_validations</span> = <span class="ruby-keyword kw">true</span>
30:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000090" class="method-detail">
        <a name="M000090"></a>

        <div class="method-heading">
          <a href="#M000090" class="method-signature">
          <span class="method-name">skip_superclass_validations?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Instructs the model to skip <a
href="ClassMethods.html#M000103">validations</a> defined in superclasses
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000090-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000090-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 33</span>
33:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">skip_superclass_validations?</span>
34:           <span class="ruby-keyword kw">defined?</span>(<span class="ruby-ivar">@skip_superclass_validations</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@skip_superclass_validations</span>
35:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000092" class="method-detail">
        <a name="M000092"></a>

        <div class="method-heading">
          <a href="#M000092" class="method-signature">
          <span class="method-name">validate</span><span class="method-args">(o)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates the given instance.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000092-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000092-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 57</span>
57:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validate</span>(<span class="ruby-identifier">o</span>)
58:           <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">validate</span>(<span class="ruby-identifier">o</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:validate</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">skip_superclass_validations?</span>
59:           <span class="ruby-identifier">validations</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">att</span>, <span class="ruby-identifier">procs</span><span class="ruby-operator">|</span>
60:             <span class="ruby-identifier">v</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">att</span>
61:             <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
62:               <span class="ruby-identifier">att</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">a</span>)}
63:             <span class="ruby-keyword kw">else</span>
64:               <span class="ruby-identifier">o</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">att</span>)
65:             <span class="ruby-keyword kw">end</span>
66:             <span class="ruby-identifier">procs</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">tag</span>, <span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">o</span>, <span class="ruby-identifier">att</span>, <span class="ruby-identifier">v</span>)}
67:           <span class="ruby-keyword kw">end</span>
68:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000091" class="method-detail">
        <a name="M000091"></a>

        <div class="method-heading">
          <a href="#M000091" class="method-signature">
          <span class="method-name">validates</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Defines <a href="ClassMethods.html#M000103">validations</a> by converting a
longhand block into a series of shorthand definitions. For example:
</p>
<pre>
  class MyClass &lt; Sequel::Model
    validates do
      length_of :name, :minimum =&gt; 6
      length_of :password, :minimum =&gt; 8
    end
  end
</pre>
<p>
is equivalent to:
</p>
<pre>
  class MyClass &lt; Sequel::Model
    validates_length_of :name, :minimum =&gt; 6
    validates_length_of :password, :minimum =&gt; 8
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000091-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000091-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 52</span>
52:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validates</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
53:           <span class="ruby-constant">Generator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
54:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000093" class="method-detail">
        <a name="M000093"></a>

        <div class="method-heading">
          <a href="#M000093" class="method-signature">
          <span class="method-name">validates_acceptance_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates acceptance of an attribute. Just checks that the value is equal
to the :accept option. This method is unique in that :allow_nil is assumed
to be true instead of false.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:accept - The value required for the object to be valid (default:
&#8216;1&#8217;)

</li>
<li>:message - The message to use (default: &#8216;is not accepted&#8217;)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000093-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000093-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 77</span>
77:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validates_acceptance_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
78:           <span class="ruby-identifier">opts</span> = {
79:             <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is not accepted'</span>,
80:             <span class="ruby-identifier">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,
81:             <span class="ruby-identifier">:accept</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'1'</span>,
82:             <span class="ruby-identifier">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:acceptance</span>,
83:           }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))
84:           <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>
85:           <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
86:             <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:accept</span>]
87:           <span class="ruby-keyword kw">end</span>
88:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000094" class="method-detail">
        <a name="M000094"></a>

        <div class="method-heading">
          <a href="#M000094" class="method-signature">
          <span class="method-name">validates_confirmation_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates confirmation of an attribute. Checks that the object has a
_confirmation value matching the current value. For example:
</p>
<pre>
  validates_confirmation_of :blah
</pre>
<p>
Just makes sure that object.blah = object.blah_confirmation. Often used for
passwords or email addresses on web forms.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:message - The message to use (default: &#8216;is not confirmed&#8217;)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000094-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000094-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 100</span>
100:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validates_confirmation_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
101:           <span class="ruby-identifier">opts</span> = {
102:             <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is not confirmed'</span>,
103:             <span class="ruby-identifier">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:confirmation</span>,
104:           }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))
105:           <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>
106:           <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
107:             <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{a}_confirmation&quot;</span><span class="ruby-node">&quot;#{a}_confirmation&quot;</span>)
108:           <span class="ruby-keyword kw">end</span>
109:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000095" class="method-detail">
        <a name="M000095"></a>

        <div class="method-heading">
          <a href="#M000095" class="method-signature">
          <span class="method-name">validates_each</span><span class="method-args">(*atts, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds a validation for each of the given attributes using the supplied
block. The block must accept three arguments: instance, attribute and
value, e.g.:
</p>
<pre>
  validates_each :name, :password do |object, attribute, value|
    object.errors.add(attribute, 'is not nice') unless value.nice?
  end
</pre>
<p>
Possible Options:
</p>
<ul>
<li>:allow_blank - Whether to skip the validation if the value is blank.

</li>
<li>:allow_missing - Whether to skip the validation if the attribute
isn&#8216;t a key in the values hash. This is different from allow_nil,
because <a href="../../../Sequel.html">Sequel</a> only sends the attributes
in the values when doing an insert or update. If the attribute is not
present, <a href="../../../Sequel.html">Sequel</a> doesn&#8216;t specify
it, so the database will use the table&#8216;s default value. This is
different from having an attribute in values with a value of nil, which <a
href="../../../Sequel.html">Sequel</a> will send as NULL. If your database
table has a non NULL default, this may be a good option to use. You
don&#8216;t want to use allow_nil, because if the attribute is in values
but has a value nil, <a href="../../../Sequel.html">Sequel</a> will attempt
to insert a NULL value into the database, instead of using the
database&#8216;s default.

</li>
<li>:allow_nil - Whether to skip the validation if the value is nil.

</li>
<li>:if - A symbol (indicating an instance_method) or proc (which is
instance_evaled) skipping this validation if it returns nil or false.

</li>
<li>:tag - The tag to use for this validation.

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000095-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000095-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 134</span>
134:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
135:           <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>)
136:           <span class="ruby-identifier">blk</span> = <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">i</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:if</span>]) <span class="ruby-operator">||</span> (<span class="ruby-identifier">am</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_missing</span>]) <span class="ruby-operator">||</span> (<span class="ruby-identifier">an</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_nil</span>]) <span class="ruby-operator">||</span> (<span class="ruby-identifier">ab</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:allow_blank</span>])
137:             <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>,<span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
138:               <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">validation_if_proc</span>(<span class="ruby-identifier">o</span>, <span class="ruby-identifier">i</span>)
139:               <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">an</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">v</span>).<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">nil?</span>}
140:               <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ab</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">v</span>).<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">blank?</span>}
141:               <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">am</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">a</span>).<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">x</span>)}
142:               <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">o</span>,<span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>)
143:             <span class="ruby-keyword kw">end</span>
144:           <span class="ruby-keyword kw">else</span>
145:             <span class="ruby-identifier">block</span>
146:           <span class="ruby-keyword kw">end</span>
147:           <span class="ruby-identifier">tag</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:tag</span>]
148:           <span class="ruby-identifier">atts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> 
149:             <span class="ruby-identifier">a_vals</span> = <span class="ruby-identifier">validations</span>[<span class="ruby-identifier">a</span>]
150:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tag</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">old</span> = <span class="ruby-identifier">a_vals</span>.<span class="ruby-identifier">find</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">tag</span>})
151:               <span class="ruby-identifier">old</span>[<span class="ruby-value">1</span>] = <span class="ruby-identifier">blk</span>
152:             <span class="ruby-keyword kw">else</span>
153:               <span class="ruby-identifier">a_vals</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">tag</span>, <span class="ruby-identifier">blk</span>]
154:             <span class="ruby-keyword kw">end</span>
155:           <span class="ruby-keyword kw">end</span>
156:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000096" class="method-detail">
        <a name="M000096"></a>

        <div class="method-heading">
          <a href="#M000096" class="method-signature">
          <span class="method-name">validates_format_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates the format of an attribute, checking the string representation of
the value against the regular expression provided by the :with option.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:message - The message to use (default: &#8216;is invalid&#8217;)

</li>
<li>:with - The regular expression to <a
href="ClassMethods.html#M000092">validate</a> the value with (required).

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000096-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000096-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 164</span>
164:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validates_format_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
165:           <span class="ruby-identifier">opts</span> = {
166:             <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is invalid'</span>,
167:             <span class="ruby-identifier">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:format</span>,
168:           }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))
169:           
170:           <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:with</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Regexp</span>)
171:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;A regular expression must be supplied as the :with option of the options hash&quot;</span>
172:           <span class="ruby-keyword kw">end</span>
173:           
174:           <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>
175:           <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
176:             <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:with</span>]
177:           <span class="ruby-keyword kw">end</span>
178:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000101" class="method-detail">
        <a name="M000101"></a>

        <div class="method-heading">
          <a href="#M000101" class="method-signature">
          <span class="method-name">validates_inclusion_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates that an attribute is within a specified range or set of values.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:in - An array or range of values to check for validity (required)

</li>
<li>:message - The message to use (default: &#8216;is not in range or set:
&lt;specified range&gt;&#8217;)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000101-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000101-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 290</span>
290:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validates_inclusion_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
291:           <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>)
292:           <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:in</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:in</span>].<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:include?</span>) 
293:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;The :in parameter is required, and respond to include?&quot;</span>
294:           <span class="ruby-keyword kw">end</span>
295:           <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-operator">||=</span> <span class="ruby-node">&quot;is not in range or set: #{opts[:in].inspect}&quot;</span>
296:           <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>
297:           <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
298:             <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:in</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">v</span>)
299:           <span class="ruby-keyword kw">end</span>
300:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000097" class="method-detail">
        <a name="M000097"></a>

        <div class="method-heading">
          <a href="#M000097" class="method-signature">
          <span class="method-name">validates_length_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates the length of an attribute.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:is - The exact size required for the value to be valid (no default)

</li>
<li>:maximum - The maximum size allowed for the value (no default)

</li>
<li>:message - The message to use (no default, overrides :too_long, :too_short,
and :wrong_length options if present)

</li>
<li>:minimum - The minimum size allowed for the value (no default)

</li>
<li>:too_long - The message to use use if it the value is too long (default:
&#8216;is too long&#8217;)

</li>
<li>:too_short - The message to use use if it the value is too short (default:
&#8216;is too short&#8217;)

</li>
<li>:within - The array/range that must include the size of the value for it to
be valid (no default)

</li>
<li>:wrong_length - The message to use use if it the value is not valid
(default: &#8216;is the wrong length&#8217;)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000097-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000097-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 192</span>
192:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validates_length_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
193:           <span class="ruby-identifier">opts</span> = {
194:             <span class="ruby-identifier">:too_long</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is too long'</span>,
195:             <span class="ruby-identifier">:too_short</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is too short'</span>,
196:             <span class="ruby-identifier">:wrong_length</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is the wrong length'</span>
197:           }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))
198:           
199:           <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:tag</span>] <span class="ruby-operator">||=</span> ([<span class="ruby-identifier">:length</span>] <span class="ruby-operator">+</span> [<span class="ruby-identifier">:maximum</span>, <span class="ruby-identifier">:minimum</span>, <span class="ruby-identifier">:is</span>, <span class="ruby-identifier">:within</span>].<span class="ruby-identifier">reject</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">opts</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">x</span>)}).<span class="ruby-identifier">join</span>(<span class="ruby-value str">'-'</span>).<span class="ruby-identifier">to_sym</span>
200:           <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>
201:           <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
202:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:maximum</span>]
203:               <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:too_long</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">m</span>
204:             <span class="ruby-keyword kw">end</span>
205:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:minimum</span>]
206:               <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:too_short</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">m</span>
207:             <span class="ruby-keyword kw">end</span>
208:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">i</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:is</span>]
209:               <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:wrong_length</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">i</span>
210:             <span class="ruby-keyword kw">end</span>
211:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">w</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:within</span>]
212:               <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:wrong_length</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">w</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">size</span>)
213:             <span class="ruby-keyword kw">end</span>
214:           <span class="ruby-keyword kw">end</span>
215:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000098" class="method-detail">
        <a name="M000098"></a>

        <div class="method-heading">
          <a href="#M000098" class="method-signature">
          <span class="method-name">validates_not_string</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates whether an attribute is not a string. This is generally useful in
conjunction with raise_on_typecast_failure = false, where you are passing
in string values for non-string attributes (such as numbers and dates). If
typecasting fails (invalid number or date), the value of the attribute will
be a string in an invalid format, and if typecasting succeeds, the value
will not be a string.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:message - The message to use (default: &#8216;is a string&#8217; or
&#8216;is not a valid (integer|datetime|etc.)&#8217; if the type is known)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000098-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000098-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 226</span>
226:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validates_not_string</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
227:           <span class="ruby-identifier">opts</span> = {
228:             <span class="ruby-identifier">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:not_string</span>,
229:           }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))
230:           <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>
231:           <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
232:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
233:               <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">message</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>]
234:                 <span class="ruby-identifier">message</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sch</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">db_schema</span>[<span class="ruby-identifier">a</span>] <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">typ</span> = <span class="ruby-identifier">sch</span>[<span class="ruby-identifier">:type</span>]
235:                   <span class="ruby-node">&quot;is not a valid #{typ}&quot;</span>
236:                 <span class="ruby-keyword kw">else</span>
237:                   <span class="ruby-value str">&quot;is a string&quot;</span>
238:                 <span class="ruby-keyword kw">end</span>
239:               <span class="ruby-keyword kw">end</span>
240:               <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">message</span>)
241:             <span class="ruby-keyword kw">end</span>
242:           <span class="ruby-keyword kw">end</span>
243:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000099" class="method-detail">
        <a name="M000099"></a>

        <div class="method-heading">
          <a href="#M000099" class="method-signature">
          <span class="method-name">validates_numericality_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates whether an attribute is a number.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:message - The message to use (default: &#8216;is not a number&#8217;)

</li>
<li>:only_integer - Whether only integers are valid values (default: false)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000099-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000099-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 250</span>
250:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validates_numericality_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
251:           <span class="ruby-identifier">opts</span> = {
252:             <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is not a number'</span>,
253:             <span class="ruby-identifier">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:numericality</span>,
254:           }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))
255:           <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>
256:           <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
257:             <span class="ruby-keyword kw">begin</span>
258:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:only_integer</span>]
259:                 <span class="ruby-constant">Kernel</span>.<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>)
260:               <span class="ruby-keyword kw">else</span>
261:                 <span class="ruby-constant">Kernel</span>.<span class="ruby-constant">Float</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>)
262:               <span class="ruby-keyword kw">end</span>
263:             <span class="ruby-keyword kw">rescue</span>
264:               <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>])
265:             <span class="ruby-keyword kw">end</span>
266:           <span class="ruby-keyword kw">end</span>
267:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000100" class="method-detail">
        <a name="M000100"></a>

        <div class="method-heading">
          <a href="#M000100" class="method-signature">
          <span class="method-name">validates_presence_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates the presence of an attribute. Requires the value not be blank,
with false considered present instead of absent.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:message - The message to use (default: &#8216;is not present&#8217;)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000100-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000100-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 274</span>
274:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validates_presence_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
275:           <span class="ruby-identifier">opts</span> = {
276:             <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is not present'</span>,
277:             <span class="ruby-identifier">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:presence</span>,
278:           }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))
279:           <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>
280:           <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
281:             <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">false</span>
282:           <span class="ruby-keyword kw">end</span>
283:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000102" class="method-detail">
        <a name="M000102"></a>

        <div class="method-heading">
          <a href="#M000102" class="method-signature">
          <span class="method-name">validates_uniqueness_of</span><span class="method-args">(*atts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates only if the fields in the model (specified by atts) are unique in
the database. Pass an array of fields instead of multiple fields to specify
that the combination of fields must be unique, instead of that each field
should have a unique value.
</p>
<p>
This means that the code:
</p>
<pre>
  validates_uniqueness_of([:column1, :column2])
</pre>
<p>
<a href="ClassMethods.html#M000091">validates</a> the grouping of column1
and column2 while
</p>
<pre>
  validates_uniqueness_of(:column1, :column2)
</pre>
<p>
<a href="ClassMethods.html#M000091">validates</a> them separately.
</p>
<p>
You should also add a unique index in the database, as this suffers from a
fairly obvious race condition.
</p>
<p>
Possible Options:
</p>
<ul>
<li>:message - The message to use (default: &#8216;is already taken&#8217;)

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000102-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000102-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 318</span>
318:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>)
319:           <span class="ruby-identifier">opts</span> = {
320:             <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'is already taken'</span>,
321:             <span class="ruby-identifier">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:uniqueness</span>,
322:           }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))
323:     
324:           <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>
325:           <span class="ruby-identifier">validates_each</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">atts</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
326:             <span class="ruby-identifier">error_field</span> = <span class="ruby-identifier">a</span>
327:             <span class="ruby-identifier">a</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">a</span>)
328:             <span class="ruby-identifier">v</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">v</span>)
329:             <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">a</span>.<span class="ruby-identifier">zip</span>(<span class="ruby-identifier">v</span>))
330:             <span class="ruby-identifier">num_dups</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">count</span>
331:             <span class="ruby-identifier">allow</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">num_dups</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
332:               <span class="ruby-comment cmt"># No unique value in the database</span>
333:               <span class="ruby-keyword kw">true</span>
334:             <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">num_dups</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
335:               <span class="ruby-comment cmt"># Multiple &quot;unique&quot; values in the database!!</span>
336:               <span class="ruby-comment cmt"># Someone didn't add a unique index</span>
337:               <span class="ruby-keyword kw">false</span>
338:             <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">new?</span>
339:               <span class="ruby-comment cmt"># New record, but unique value already exists in the database</span>
340:               <span class="ruby-keyword kw">false</span>
341:             <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">o</span>
342:               <span class="ruby-comment cmt"># Unique value exists in database, but for the same record, so the update won't cause a duplicate record</span>
343:               <span class="ruby-keyword kw">true</span>
344:             <span class="ruby-keyword kw">else</span>
345:               <span class="ruby-keyword kw">false</span>
346:             <span class="ruby-keyword kw">end</span>
347:             <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">error_field</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:message</span>]) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">allow</span>
348:           <span class="ruby-keyword kw">end</span>
349:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000103" class="method-detail">
        <a name="M000103"></a>

        <div class="method-heading">
          <a href="#M000103" class="method-signature">
          <span class="method-name">validations</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="ClassMethods.html#M000103">validations</a> hash for
the class.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000103-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000103-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/plugins/validation_class_methods.rb, line 352</span>
352:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validations</span>
353:           <span class="ruby-ivar">@validations</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">h</span>, <span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">k</span>] = []}
354:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>