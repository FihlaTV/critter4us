<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Sequel::Dataset</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Sequel::Dataset</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/sequel/adapters/do_rb.html">
                lib/sequel/adapters/do.rb
                </a>
        <br />
                <a href="../../files/lib/sequel/adapters/jdbc_rb.html">
                lib/sequel/adapters/jdbc.rb
                </a>
        <br />
                <a href="../../files/lib/sequel/adapters/utils/stored_procedures_rb.html">
                lib/sequel/adapters/utils/stored_procedures.rb
                </a>
        <br />
                <a href="../../files/lib/sequel/adapters/utils/unsupported_rb.html">
                lib/sequel/adapters/utils/unsupported.rb
                </a>
        <br />
                <a href="../../files/lib/sequel/dataset/convenience_rb.html">
                lib/sequel/dataset/convenience.rb
                </a>
        <br />
                <a href="../../files/lib/sequel/dataset/graph_rb.html">
                lib/sequel/dataset/graph.rb
                </a>
        <br />
                <a href="../../files/lib/sequel/dataset/prepared_statements_rb.html">
                lib/sequel/dataset/prepared_statements.rb
                </a>
        <br />
                <a href="../../files/lib/sequel/dataset/sql_rb.html">
                lib/sequel/dataset/sql.rb
                </a>
        <br />
                <a href="../../files/lib/sequel/dataset_rb.html">
                lib/sequel/dataset.rb
                </a>
        <br />
                <a href="../../files/lib/sequel/extensions/pagination_rb.html">
                lib/sequel/extensions/pagination.rb
                </a>
        <br />
                <a href="../../files/lib/sequel/extensions/pretty_table_rb.html">
                lib/sequel/extensions/pretty_table.rb
                </a>
        <br />
                <a href="../../files/lib/sequel/extensions/query_rb.html">
                lib/sequel/extensions/query.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="Dataset.html">
                Sequel::Dataset
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
A dataset represents an <a href="SQL.html">SQL</a> <a
href="Dataset.html#M000767">query</a>, <a
href="Dataset.html#M000716">or</a> more generally, an abstract <a
href="Dataset.html#M000759">set</a> of rows in the database. Datasets can
be used to create, retrieve, <a href="Dataset.html#M000762">update</a> <a
href="Dataset.html#M000683">and</a> <a
href="Dataset.html#M000751">delete</a> records.
</p>
<p>
Query results are always retrieved on demand, so a dataset can be kept
around <a href="Dataset.html#M000683">and</a> reused indefinitely (datasets
never cache results):
</p>
<pre>
  my_posts = DB[:posts].filter(:author =&gt; 'david') # no records are retrieved
  my_posts.all # records are retrieved
  my_posts.all # records are retrieved again
</pre>
<p>
Most dataset methods return modified copies of the dataset (functional
style), so you can reuse different datasets to access data:
</p>
<pre>
  posts = DB[:posts]
  davids_posts = posts.filter(:author =&gt; 'david')
  old_posts = posts.filter('stamp &lt; ?', Date.today - 7)
  davids_old_posts = davids_posts.filter('stamp &lt; ?', Date.today - 7)
</pre>
<p>
Datasets are Enumerable objects, so they can be manipulated using any of
the Enumerable methods, such <a href="Dataset.html#M000745">as</a> <a
href="Dataset.html#M000666">map</a>, inject, etc.
</p>
<h3>Methods added via metaprogramming</h3>
<p>
Some methods are added via metaprogramming:
</p>
<ul>
<li>! methods - These methods are the same <a
href="Dataset.html#M000745">as</a> their non-! counterparts, but they
modify the receiver instead of returning a modified copy of the dataset.

</li>
<li>inner_join, full_outer_join, right_outer_join, left_outer_join - This
methods are shortcuts to <a href="Dataset.html#M000712">join_table</a> with
the join type already specified.

</li>
</ul>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000744">&lt;&lt;</a>&nbsp;&nbsp;
      <a href="#M000656">[]</a>&nbsp;&nbsp;
      <a href="#M000657">[]=</a>&nbsp;&nbsp;
      <a href="#M000679">add_graph_aliases</a>&nbsp;&nbsp;
      <a href="#M000684">aliased_expression_sql</a>&nbsp;&nbsp;
      <a href="#M000746">all</a>&nbsp;&nbsp;
      <a href="#M000683">and</a>&nbsp;&nbsp;
      <a href="#M000685">array_sql</a>&nbsp;&nbsp;
      <a href="#M000745">as</a>&nbsp;&nbsp;
      <a href="#M000658">avg</a>&nbsp;&nbsp;
      <a href="#M000680">call</a>&nbsp;&nbsp;
      <a href="#M000686">case_expression_sql</a>&nbsp;&nbsp;
      <a href="#M000687">cast_sql</a>&nbsp;&nbsp;
      <a href="#M000747">clone</a>&nbsp;&nbsp;
      <a href="#M000688">column_all_sql</a>&nbsp;&nbsp;
      <a href="#M000748">columns</a>&nbsp;&nbsp;
      <a href="#M000749">columns!</a>&nbsp;&nbsp;
      <a href="#M000689">complex_expression_sql</a>&nbsp;&nbsp;
      <a href="#M000690">count</a>&nbsp;&nbsp;
      <a href="#M000750">def_mutation_method</a>&nbsp;&nbsp;
      <a href="#M000743">def_mutation_method</a>&nbsp;&nbsp;
      <a href="#M000751">delete</a>&nbsp;&nbsp;
      <a href="#M000691">delete_sql</a>&nbsp;&nbsp;
      <a href="#M000692">distinct</a>&nbsp;&nbsp;
      <a href="#M000752">each</a>&nbsp;&nbsp;
      <a href="#M000765">each_page</a>&nbsp;&nbsp;
      <a href="#M000659">empty?</a>&nbsp;&nbsp;
      <a href="#M000693">except</a>&nbsp;&nbsp;
      <a href="#M000694">exclude</a>&nbsp;&nbsp;
      <a href="#M000695">exists</a>&nbsp;&nbsp;
      <a href="#M000753">fetch_rows</a>&nbsp;&nbsp;
      <a href="#M000654">fetch_rows</a>&nbsp;&nbsp;
      <a href="#M000653">fetch_rows</a>&nbsp;&nbsp;
      <a href="#M000696">filter</a>&nbsp;&nbsp;
      <a href="#M000660">first</a>&nbsp;&nbsp;
      <a href="#M000697">first_source</a>&nbsp;&nbsp;
      <a href="#M000698">from</a>&nbsp;&nbsp;
      <a href="#M000699">from_self</a>&nbsp;&nbsp;
      <a href="#M000700">function_sql</a>&nbsp;&nbsp;
      <a href="#M000661">get</a>&nbsp;&nbsp;
      <a href="#M000677">graph</a>&nbsp;&nbsp;
      <a href="#M000701">grep</a>&nbsp;&nbsp;
      <a href="#M000702">group</a>&nbsp;&nbsp;
      <a href="#M000662">group_and_count</a>&nbsp;&nbsp;
      <a href="#M000703">group_by</a>&nbsp;&nbsp;
      <a href="#M000704">having</a>&nbsp;&nbsp;
      <a href="#M000663">import</a>&nbsp;&nbsp;
      <a href="#M000754">insert</a>&nbsp;&nbsp;
      <a href="#M000705">insert_multiple</a>&nbsp;&nbsp;
      <a href="#M000706">insert_sql</a>&nbsp;&nbsp;
      <a href="#M000755">inspect</a>&nbsp;&nbsp;
      <a href="#M000707">intersect</a>&nbsp;&nbsp;
      <a href="#M000664">interval</a>&nbsp;&nbsp;
      <a href="#M000708">invert</a>&nbsp;&nbsp;
      <a href="#M000709">join_clause_sql</a>&nbsp;&nbsp;
      <a href="#M000710">join_on_clause_sql</a>&nbsp;&nbsp;
      <a href="#M000712">join_table</a>&nbsp;&nbsp;
      <a href="#M000711">join_using_clause_sql</a>&nbsp;&nbsp;
      <a href="#M000665">last</a>&nbsp;&nbsp;
      <a href="#M000713">limit</a>&nbsp;&nbsp;
      <a href="#M000714">literal</a>&nbsp;&nbsp;
      <a href="#M000666">map</a>&nbsp;&nbsp;
      <a href="#M000667">max</a>&nbsp;&nbsp;
      <a href="#M000668">min</a>&nbsp;&nbsp;
      <a href="#M000669">multi_insert</a>&nbsp;&nbsp;
      <a href="#M000715">multi_insert_sql</a>&nbsp;&nbsp;
      <a href="#M000756">naked</a>&nbsp;&nbsp;
      <a href="#M000742">new</a>&nbsp;&nbsp;
      <a href="#M000763">options_overlap</a>&nbsp;&nbsp;
      <a href="#M000716">or</a>&nbsp;&nbsp;
      <a href="#M000717">order</a>&nbsp;&nbsp;
      <a href="#M000718">order_by</a>&nbsp;&nbsp;
      <a href="#M000719">order_more</a>&nbsp;&nbsp;
      <a href="#M000720">ordered_expression_sql</a>&nbsp;&nbsp;
      <a href="#M000764">paginate</a>&nbsp;&nbsp;
      <a href="#M000721">placeholder_literal_string_sql</a>&nbsp;&nbsp;
      <a href="#M000655">prepare</a>&nbsp;&nbsp;
      <a href="#M000681">prepare</a>&nbsp;&nbsp;
      <a href="#M000766">print</a>&nbsp;&nbsp;
      <a href="#M000722">qualified_identifier_sql</a>&nbsp;&nbsp;
      <a href="#M000767">query</a>&nbsp;&nbsp;
      <a href="#M000723">quote_identifier</a>&nbsp;&nbsp;
      <a href="#M000757">quote_identifiers?</a>&nbsp;&nbsp;
      <a href="#M000724">quote_schema_table</a>&nbsp;&nbsp;
      <a href="#M000725">quoted_identifier</a>&nbsp;&nbsp;
      <a href="#M000670">range</a>&nbsp;&nbsp;
      <a href="#M000727">reverse</a>&nbsp;&nbsp;
      <a href="#M000726">reverse_order</a>&nbsp;&nbsp;
      <a href="#M000728">schema_and_table</a>&nbsp;&nbsp;
      <a href="#M000729">select</a>&nbsp;&nbsp;
      <a href="#M000730">select_all</a>&nbsp;&nbsp;
      <a href="#M000731">select_more</a>&nbsp;&nbsp;
      <a href="#M000732">select_sql</a>&nbsp;&nbsp;
      <a href="#M000758">server</a>&nbsp;&nbsp;
      <a href="#M000759">set</a>&nbsp;&nbsp;
      <a href="#M000760">set_defaults</a>&nbsp;&nbsp;
      <a href="#M000678">set_graph_aliases</a>&nbsp;&nbsp;
      <a href="#M000761">set_overrides</a>&nbsp;&nbsp;
      <a href="#M000671">single_record</a>&nbsp;&nbsp;
      <a href="#M000672">single_value</a>&nbsp;&nbsp;
      <a href="#M000733">sql</a>&nbsp;&nbsp;
      <a href="#M000734">subscript_sql</a>&nbsp;&nbsp;
      <a href="#M000673">sum</a>&nbsp;&nbsp;
      <a href="#M000674">table_exists?</a>&nbsp;&nbsp;
      <a href="#M000675">to_csv</a>&nbsp;&nbsp;
      <a href="#M000676">to_hash</a>&nbsp;&nbsp;
      <a href="#M000682">to_prepared_statement</a>&nbsp;&nbsp;
      <a href="#M000741">to_table_reference</a>&nbsp;&nbsp;
      <a href="#M000735">unfiltered</a>&nbsp;&nbsp;
      <a href="#M000736">union</a>&nbsp;&nbsp;
      <a href="#M000737">unordered</a>&nbsp;&nbsp;
      <a href="#M000762">update</a>&nbsp;&nbsp;
      <a href="#M000738">update_sql</a>&nbsp;&nbsp;
      <a href="#M000739">where</a>&nbsp;&nbsp;
      <a href="#M000740">with_sql</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="Dataset/StoredProcedures.html">StoredProcedures</a></span>
        <span class="include-name"><a href="Metaprogramming.html">Metaprogramming</a></span>
        <span class="include-name">Enumerable</span>
      </div>
    </div>

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Module <a href="Dataset/ArgumentMapper.html" class="link">Sequel::Dataset::ArgumentMapper</a><br />
Module <a href="Dataset/Pagination.html" class="link">Sequel::Dataset::Pagination</a><br />
Module <a href="Dataset/PreparedStatementMethods.html" class="link">Sequel::Dataset::PreparedStatementMethods</a><br />
Module <a href="Dataset/QueryBlockCopy.html" class="link">Sequel::Dataset::QueryBlockCopy</a><br />
Module <a href="Dataset/SQLStandardDateFormat.html" class="link">Sequel::Dataset::SQLStandardDateFormat</a><br />
Module <a href="Dataset/StoredProcedureMethods.html" class="link">Sequel::Dataset::StoredProcedureMethods</a><br />
Module <a href="Dataset/StoredProcedures.html" class="link">Sequel::Dataset::StoredProcedures</a><br />
Module <a href="Dataset/UnnumberedArgumentMapper.html" class="link">Sequel::Dataset::UnnumberedArgumentMapper</a><br />
Module <a href="Dataset/UnsupportedIntersectExcept.html" class="link">Sequel::Dataset::UnsupportedIntersectExcept</a><br />
Module <a href="Dataset/UnsupportedIntersectExceptAll.html" class="link">Sequel::Dataset::UnsupportedIntersectExceptAll</a><br />
Module <a href="Dataset/UnsupportedIsTrue.html" class="link">Sequel::Dataset::UnsupportedIsTrue</a><br />

    </div>

    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COMMA_SEPARATOR</td>
          <td>=</td>
          <td class="context-item-value">', '.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COUNT_OF_ALL_AS_COUNT</td>
          <td>=</td>
          <td class="context-item-value">SQL::Function.new(:count, LiteralString.new('*'.freeze)).as(:count)</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ARRAY_ACCESS_ERROR_MSG</td>
          <td>=</td>
          <td class="context-item-value">'You cannot call Dataset#[] with an integer or with no arguments.'.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">MAP_ERROR_MSG</td>
          <td>=</td>
          <td class="context-item-value">'Using Dataset#map with an argument and a block is not allowed'.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">GET_ERROR_MSG</td>
          <td>=</td>
          <td class="context-item-value">'must provide argument or block to Dataset#get, not both'.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">IMPORT_ERROR_MSG</td>
          <td>=</td>
          <td class="context-item-value">'Using Sequel::Dataset#import an empty column array is not allowed'.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">PREPARED_ARG_PLACEHOLDER</td>
          <td>=</td>
          <td class="context-item-value">LiteralString.new('?').freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">AND_SEPARATOR</td>
          <td>=</td>
          <td class="context-item-value">&quot; AND &quot;.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">BOOL_FALSE</td>
          <td>=</td>
          <td class="context-item-value">&quot;'f'&quot;.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">BOOL_TRUE</td>
          <td>=</td>
          <td class="context-item-value">&quot;'t'&quot;.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COLUMN_REF_RE1</td>
          <td>=</td>
          <td class="context-item-value">/\A([\w ]+)__([\w ]+)___([\w ]+)\z/.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COLUMN_REF_RE2</td>
          <td>=</td>
          <td class="context-item-value">/\A([\w ]+)___([\w ]+)\z/.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COLUMN_REF_RE3</td>
          <td>=</td>
          <td class="context-item-value">/\A([\w ]+)__([\w ]+)\z/.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COUNT_FROM_SELF_OPTS</td>
          <td>=</td>
          <td class="context-item-value">[:distinct, :group, :sql, :limit, :compounds]</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">IS_LITERALS</td>
          <td>=</td>
          <td class="context-item-value">{nil=&gt;'NULL'.freeze, true=&gt;'TRUE'.freeze, false=&gt;'FALSE'.freeze}.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">IS_OPERATORS</td>
          <td>=</td>
          <td class="context-item-value">::Sequel::SQL::ComplexExpression::IS_OPERATORS</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">N_ARITY_OPERATORS</td>
          <td>=</td>
          <td class="context-item-value">::Sequel::SQL::ComplexExpression::N_ARITY_OPERATORS</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">NULL</td>
          <td>=</td>
          <td class="context-item-value">&quot;NULL&quot;.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">QUESTION_MARK</td>
          <td>=</td>
          <td class="context-item-value">'?'.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">STOCK_COUNT_OPTS</td>
          <td>=</td>
          <td class="context-item-value">{:select =&gt; [SQL::AliasedExpression.new(LiteralString.new(&quot;COUNT(*)&quot;).freeze, :count)], :order =&gt; nil}.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">SELECT_CLAUSE_ORDER</td>
          <td>=</td>
          <td class="context-item-value">%w'distinct columns from join where group having compounds order limit'.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">TWO_ARITY_OPERATORS</td>
          <td>=</td>
          <td class="context-item-value">::Sequel::SQL::ComplexExpression::TWO_ARITY_OPERATORS</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">WILDCARD</td>
          <td>=</td>
          <td class="context-item-value">'*'.freeze</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COLUMN_CHANGE_OPTS</td>
          <td>=</td>
          <td class="context-item-value">[:select, :sql, :from, :join].freeze</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The dataset options that require the removal of cached <a
href="Dataset.html#M000748">columns</a> if changed.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">MUTATION_METHODS</td>
          <td>=</td>
          <td class="context-item-value">%w'add_graph_aliases and distinct exclude exists     filter from from_self full_outer_join graph     group group_and_count group_by having inner_join intersect invert join     left_outer_join limit naked or order order_by order_more paginate query reject     reverse reverse_order right_outer_join select select_all select_more     set_defaults set_graph_aliases set_overrides sort sort_by     unfiltered union unordered where with_sql'.collect{|x| x.to_sym}</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
All methods that should have a ! method added that modifies the receiver.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">NOTIMPL_MSG</td>
          <td>=</td>
          <td class="context-item-value">&quot;This method must be overridden in Sequel adapters&quot;.freeze</td>
        </tr>
        </table>
      </div>
    </div>

    <div id="aliases-list">
      <h3 class="section-bar">External Aliases</h3>

      <div class="name-list">
                        <table summary="aliases">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">inner_join</td>
          <td>-&gt;</td>
          <td class="context-item-value">join</td>
        </tr>
                        </table>
      </div>
    </div>


    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">db</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
The database that corresponds to this dataset

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">identifier_input_method</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Set the method to <a href="Dataset.html#M000680">call</a> on identifiers
going into the database for this dataset

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">identifier_output_method</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Set the method to <a href="Dataset.html#M000680">call</a> on identifiers
coming the database for this dataset

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">opts</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
The hash of options for this dataset, keys are symbols.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">quote_identifiers</td>
          <td class="context-item-value">&nbsp;[W]&nbsp;</td>
          <td class="context-item-desc">
Whether to quote identifiers for this dataset

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">row_proc</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
The row_proc for this database, should be a Proc that takes a single hash
argument <a href="Dataset.html#M000683">and</a> returns the object you want
<a href="Dataset.html#M000752">each</a> to return.

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000743" class="method-detail">
        <a name="M000743"></a>

        <div class="method-heading">
          <a href="#M000743" class="method-signature">
          <span class="method-name">def_mutation_method</span><span class="method-args">(*meths)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Setup mutation (e.g. filter!) methods. These operate the same <a
href="Dataset.html#M000745">as</a> the non-! methods, but replace the
options of the current dataset with the options of the resulting dataset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000743-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000743-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 97</span>
 97:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">def_mutation_method</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">meths</span>)
 98:       <span class="ruby-identifier">meths</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">meth</span><span class="ruby-operator">|</span>
 99:         <span class="ruby-identifier">class_eval</span>(<span class="ruby-node">&quot;def #{meth}!(*args, &amp;block); mutation_method(:#{meth}, *args, &amp;block) end&quot;</span>)
100:       <span class="ruby-keyword kw">end</span>
101:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000742" class="method-detail">
        <a name="M000742"></a>

        <div class="method-heading">
          <a href="#M000742" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(db, opts = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Constructs a <a href="Dataset.html#M000742">new</a> <a
href="Dataset.html">Dataset</a> instance with an associated database <a
href="Dataset.html#M000683">and</a> options. Datasets are usually
constructed by invoking the <a href="Database.html">Database</a>#[] method:
</p>
<pre>
  DB[:posts]
</pre>
<p>
<a href="Dataset.html">Sequel::Dataset</a> is an abstract class that is not
useful by itself. Each database adaptor should provide a subclass of <a
href="Dataset.html">Sequel::Dataset</a>, <a
href="Dataset.html#M000683">and</a> have the <a
href="Database.html#M000565">Database#dataset</a> method return an instance
of that class.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000742-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000742-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 83</span>
83:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">db</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-keyword kw">nil</span>)
84:       <span class="ruby-ivar">@db</span> = <span class="ruby-identifier">db</span>
85:       <span class="ruby-ivar">@quote_identifiers</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">quote_identifiers?</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:quote_identifiers?</span>)
86:       <span class="ruby-ivar">@identifier_input_method</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">identifier_input_method</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:identifier_input_method</span>)
87:       <span class="ruby-ivar">@identifier_output_method</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">identifier_output_method</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:identifier_output_method</span>)
88:       <span class="ruby-ivar">@opts</span> = <span class="ruby-identifier">opts</span> <span class="ruby-operator">||</span> {}
89:       <span class="ruby-ivar">@row_proc</span> = <span class="ruby-keyword kw">nil</span>
90:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000744" class="method-detail">
        <a name="M000744"></a>

        <div class="method-heading">
          <a href="#M000744" class="method-signature">
          <span class="method-name">&lt;&lt;</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000754">insert</a>, but not aliased
directly so subclasses don&#8216;t have to override both methods.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000744-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000744-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 107</span>
107:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;&lt;</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
108:       <span class="ruby-identifier">insert</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
109:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000656" class="method-detail">
        <a name="M000656"></a>

        <div class="method-heading">
          <a href="#M000656" class="method-signature">
          <span class="method-name">[]</span><span class="method-args">(*conditions)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Dataset.html#M000660">first</a> record matching the
conditions. Examples:
</p>
<pre>
  ds[:id=&gt;1] =&gt; {:id=1}
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000656-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000656-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 13</span>
13:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">conditions</span>)
14:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-constant">ARRAY_ACCESS_ERROR_MSG</span>) <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">conditions</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">conditions</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">conditions</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
15:       <span class="ruby-identifier">first</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">conditions</span>)
16:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000657" class="method-detail">
        <a name="M000657"></a>

        <div class="method-heading">
          <a href="#M000657" class="method-signature">
          <span class="method-name">[]=</span><span class="method-args">(conditions, values)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Update <a href="Dataset.html#M000746">all</a> records matching the
conditions with the values specified. Examples:
</p>
<pre>
  ds[:id=&gt;1] = {:id=&gt;2} # SQL: UPDATE ... SET id = 2 WHERE id = 1
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000657-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000657-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 22</span>
22:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">conditions</span>, <span class="ruby-identifier">values</span>)
23:       <span class="ruby-identifier">filter</span>(<span class="ruby-identifier">conditions</span>).<span class="ruby-identifier">update</span>(<span class="ruby-identifier">values</span>)
24:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000679" class="method-detail">
        <a name="M000679"></a>

        <div class="method-heading">
          <a href="#M000679" class="method-signature">
          <span class="method-name">add_graph_aliases</span><span class="method-args">(graph_aliases)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds the give <a href="Dataset.html#M000677">graph</a> aliases to the list
of <a href="Dataset.html#M000677">graph</a> aliases to use, unlike <a
href="Dataset.html#M000678">set_graph_aliases</a>, which replaces the list.
See <a href="Dataset.html#M000678">set_graph_aliases</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000679-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000679-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/graph.rb, line 168</span>
168:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_graph_aliases</span>(<span class="ruby-identifier">graph_aliases</span>)
169:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">select_more</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">graph_alias_columns</span>(<span class="ruby-identifier">graph_aliases</span>))
170:       <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:graph_aliases</span>] = (<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:graph_aliases</span>] <span class="ruby-operator">||</span> {}).<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">graph_aliases</span>)
171:       <span class="ruby-identifier">ds</span>
172:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000684" class="method-detail">
        <a name="M000684"></a>

        <div class="method-heading">
          <a href="#M000684" class="method-signature">
          <span class="method-name">aliased_expression_sql</span><span class="method-args">(ae)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for the aliased expression
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000684-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000684-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 31</span>
31:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">aliased_expression_sql</span>(<span class="ruby-identifier">ae</span>)
32:       <span class="ruby-identifier">as_sql</span>(<span class="ruby-identifier">literal</span>(<span class="ruby-identifier">ae</span>.<span class="ruby-identifier">expression</span>), <span class="ruby-identifier">ae</span>.<span class="ruby-identifier">aliaz</span>)
33:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000746" class="method-detail">
        <a name="M000746"></a>

        <div class="method-heading">
          <a href="#M000746" class="method-signature">
          <span class="method-name">all</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array with <a href="Dataset.html#M000746">all</a> records in the
dataset. If a block is given, the array is iterated over after <a
href="Dataset.html#M000746">all</a> items have been loaded.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000746-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000746-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 120</span>
120:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">all</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
121:       <span class="ruby-identifier">a</span> = []
122:       <span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">r</span>}
123:       <span class="ruby-identifier">post_load</span>(<span class="ruby-identifier">a</span>)
124:       <span class="ruby-identifier">a</span>.<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
125:       <span class="ruby-identifier">a</span>
126:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000683" class="method-detail">
        <a name="M000683"></a>

        <div class="method-heading">
          <a href="#M000683" class="method-signature">
          <span class="method-name">and</span><span class="method-args">(*cond, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds an further <a href="Dataset.html#M000696">filter</a> to an existing <a
href="Dataset.html#M000696">filter</a> using AND. If no <a
href="Dataset.html#M000696">filter</a> <a
href="Dataset.html#M000695">exists</a> an error is raised. This method is
identical to <a href="Dataset.html#M000696">filter</a> <a
href="Dataset.html#M000693">except</a> it expects an existing <a
href="Dataset.html#M000696">filter</a>.
</p>
<pre>
  ds.filter(:a).and(:b) # SQL: WHERE a AND b
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000683-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000683-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 25</span>
25:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">and</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
26:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">InvalidOperation</span>, <span class="ruby-value str">&quot;No existing filter found.&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:having</span>] <span class="ruby-operator">||</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:where</span>]
27:       <span class="ruby-identifier">filter</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
28:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000685" class="method-detail">
        <a name="M000685"></a>

        <div class="method-heading">
          <a href="#M000685" class="method-signature">
          <span class="method-name">array_sql</span><span class="method-args">(a)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for the <a href="SQL.html">SQL</a>
array.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000685-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000685-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 36</span>
36:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">array_sql</span>(<span class="ruby-identifier">a</span>)
37:       <span class="ruby-identifier">a</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-value str">'(NULL)'</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot;(#{expression_list(a)})&quot;</span>     
38:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000745" class="method-detail">
        <a name="M000745"></a>

        <div class="method-heading">
          <a href="#M000745" class="method-signature">
          <span class="method-name">as</span><span class="method-args">(aliaz)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return the dataset <a href="Dataset.html#M000745">as</a> an aliased
expression with the given alias. You can use this <a
href="Dataset.html#M000745">as</a> a FROM <a
href="Dataset.html#M000716">or</a> JOIN dataset, <a
href="Dataset.html#M000716">or</a> <a href="Dataset.html#M000745">as</a> a
column if this dataset returns a single row <a
href="Dataset.html#M000683">and</a> column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000745-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000745-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 114</span>
114:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">as</span>(<span class="ruby-identifier">aliaz</span>)
115:       <span class="ruby-operator">::</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">aliaz</span>)
116:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000658" class="method-detail">
        <a name="M000658"></a>

        <div class="method-heading">
          <a href="#M000658" class="method-signature">
          <span class="method-name">avg</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the average value for the given column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000658-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000658-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 27</span>
27:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">avg</span>(<span class="ruby-identifier">column</span>)
28:       <span class="ruby-identifier">get</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">avg</span>(<span class="ruby-identifier">column</span>)}
29:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000680" class="method-detail">
        <a name="M000680"></a>

        <div class="method-heading">
          <a href="#M000680" class="method-signature">
          <span class="method-name">call</span><span class="method-args">(type, bind_variables={}, values=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
For the given type (:<a href="Dataset.html#M000729">select</a>, :<a
href="Dataset.html#M000754">insert</a>, :<a
href="Dataset.html#M000762">update</a>, <a
href="Dataset.html#M000716">or</a> :<a
href="Dataset.html#M000751">delete</a>), run the <a
href="Dataset.html#M000733">sql</a> with the bind variables specified in
the hash. values is a hash of passed to <a
href="Dataset.html#M000754">insert</a> <a
href="Dataset.html#M000716">or</a> <a
href="Dataset.html#M000762">update</a> (if one of those types is used),
which may contain placeholders.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000680-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000680-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/prepared_statements.rb, line 181</span>
181:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">call</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">bind_variables</span>={}, <span class="ruby-identifier">values</span>=<span class="ruby-keyword kw">nil</span>)
182:       <span class="ruby-identifier">prepare</span>(<span class="ruby-identifier">type</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">values</span>).<span class="ruby-identifier">call</span>(<span class="ruby-identifier">bind_variables</span>)
183:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000686" class="method-detail">
        <a name="M000686"></a>

        <div class="method-heading">
          <a href="#M000686" class="method-signature">
          <span class="method-name">case_expression_sql</span><span class="method-args">(ce)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for specifying given CaseExpression.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000686-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000686-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 41</span>
41:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">case_expression_sql</span>(<span class="ruby-identifier">ce</span>)
42:       <span class="ruby-identifier">sql</span> = <span class="ruby-value str">'(CASE '</span>
43:       <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{literal(ce.expression)} &quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ce</span>.<span class="ruby-identifier">expression</span>
44:       <span class="ruby-identifier">ce</span>.<span class="ruby-identifier">conditions</span>.<span class="ruby-identifier">collect</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">c</span>,<span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
45:         <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;WHEN #{literal(c)} THEN #{literal(r)} &quot;</span>
46:       }
47:       <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;ELSE #{literal(ce.default)} END)&quot;</span>
48:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000687" class="method-detail">
        <a name="M000687"></a>

        <div class="method-heading">
          <a href="#M000687" class="method-signature">
          <span class="method-name">cast_sql</span><span class="method-args">(expr, type)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for the <a href="SQL.html">SQL</a> CAST
expression.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000687-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000687-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 51</span>
51:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cast_sql</span>(<span class="ruby-identifier">expr</span>, <span class="ruby-identifier">type</span>)
52:       <span class="ruby-node">&quot;CAST(#{literal(expr)} AS #{db.cast_type_literal(type)})&quot;</span>
53:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000747" class="method-detail">
        <a name="M000747"></a>

        <div class="method-heading">
          <a href="#M000747" class="method-signature">
          <span class="method-name">clone</span><span class="method-args">(opts = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a <a href="Dataset.html#M000742">new</a> <a
href="Dataset.html#M000747">clone</a> of the dataset with with the given
options merged. If the options changed include options in
COLUMN_CHANGE_OPTS, the cached <a href="Dataset.html#M000748">columns</a>
are deleted.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000747-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000747-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 131</span>
131:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">opts</span> = {})
132:       <span class="ruby-identifier">c</span> = <span class="ruby-keyword kw">super</span>()
133:       <span class="ruby-identifier">c</span>.<span class="ruby-identifier">opts</span> = <span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)
134:       <span class="ruby-identifier">c</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">:@columns</span>, <span class="ruby-keyword kw">nil</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-constant">COLUMN_CHANGE_OPTS</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">o</span>)}
135:       <span class="ruby-identifier">c</span>
136:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000688" class="method-detail">
        <a name="M000688"></a>

        <div class="method-heading">
          <a href="#M000688" class="method-signature">
          <span class="method-name">column_all_sql</span><span class="method-args">(ca)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for specifying <a
href="Dataset.html#M000746">all</a> <a
href="Dataset.html#M000748">columns</a> in a given table.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000688-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000688-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 56</span>
56:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">column_all_sql</span>(<span class="ruby-identifier">ca</span>)
57:       <span class="ruby-node">&quot;#{quote_schema_table(ca.table)}.*&quot;</span>
58:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000748" class="method-detail">
        <a name="M000748"></a>

        <div class="method-heading">
          <a href="#M000748" class="method-signature">
          <span class="method-name">columns</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Dataset.html#M000748">columns</a> in the result <a
href="Dataset.html#M000759">set</a> in <a
href="Dataset.html#M000717">order</a>. If the <a
href="Dataset.html#M000748">columns</a> are currently cached, returns the
cached value. Otherwise, a SELECT <a href="Dataset.html#M000767">query</a>
is performed to <a href="Dataset.html#M000661">get</a> a single row.
Adapters are expected to fill the <a
href="Dataset.html#M000748">columns</a> cache with the column information
when a <a href="Dataset.html#M000767">query</a> is performed. If the
dataset does not have any rows, this may be an empty array depending on how
the adapter is programmed.
</p>
<p>
If you are looking for <a href="Dataset.html#M000746">all</a> <a
href="Dataset.html#M000748">columns</a> for a single table <a
href="Dataset.html#M000683">and</a> maybe some information about <a
href="Dataset.html#M000752">each</a> column (e.g. type), see <a
href="Database.html#M000636">Database#schema</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000748-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000748-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 147</span>
147:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">columns</span>
148:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@columns</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@columns</span>
149:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">unfiltered</span>.<span class="ruby-identifier">unordered</span>.<span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:distinct</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">:limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>)
150:       <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">each</span>{<span class="ruby-keyword kw">break</span>}
151:       <span class="ruby-ivar">@columns</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-identifier">:@columns</span>)
152:       <span class="ruby-ivar">@columns</span> <span class="ruby-operator">||</span> []
153:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000749" class="method-detail">
        <a name="M000749"></a>

        <div class="method-heading">
          <a href="#M000749" class="method-signature">
          <span class="method-name">columns!</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Remove the cached list of <a href="Dataset.html#M000748">columns</a> <a
href="Dataset.html#M000683">and</a> do a SELECT <a
href="Dataset.html#M000767">query</a> to find the <a
href="Dataset.html#M000748">columns</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000749-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000749-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 157</span>
157:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">columns!</span>
158:       <span class="ruby-ivar">@columns</span> = <span class="ruby-keyword kw">nil</span>
159:       <span class="ruby-identifier">columns</span>
160:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000689" class="method-detail">
        <a name="M000689"></a>

        <div class="method-heading">
          <a href="#M000689" class="method-signature">
          <span class="method-name">complex_expression_sql</span><span class="method-args">(op, args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for complex expressions
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000689-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000689-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 61</span>
61:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">complex_expression_sql</span>(<span class="ruby-identifier">op</span>, <span class="ruby-identifier">args</span>)
62:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">op</span>
63:       <span class="ruby-keyword kw">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">IS_OPERATORS</span>
64:         <span class="ruby-identifier">v</span> = <span class="ruby-constant">IS_LITERALS</span>[<span class="ruby-identifier">args</span>.<span class="ruby-identifier">at</span>(<span class="ruby-value">1</span>)] <span class="ruby-operator">||</span> <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">'Invalid argument used for IS operator'</span>)
65:         <span class="ruby-node">&quot;(#{literal(args.at(0))} #{op} #{v})&quot;</span>
66:       <span class="ruby-keyword kw">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">TWO_ARITY_OPERATORS</span>
67:         <span class="ruby-node">&quot;(#{literal(args.at(0))} #{op} #{literal(args.at(1))})&quot;</span>
68:       <span class="ruby-keyword kw">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">N_ARITY_OPERATORS</span>
69:         <span class="ruby-node">&quot;(#{args.collect{|a| literal(a)}.join(&quot; #{op} &quot;)})&quot;</span>
70:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:NOT</span>
71:         <span class="ruby-node">&quot;NOT #{literal(args.at(0))}&quot;</span>
72:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:NOOP</span>
73:         <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">at</span>(<span class="ruby-value">0</span>))
74:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'B~'</span><span class="ruby-value str">'B~'</span>
75:         <span class="ruby-node">&quot;~#{literal(args.at(0))}&quot;</span>
76:       <span class="ruby-keyword kw">else</span>
77:         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;invalid operator #{op}&quot;</span>)
78:       <span class="ruby-keyword kw">end</span>
79:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000690" class="method-detail">
        <a name="M000690"></a>

        <div class="method-heading">
          <a href="#M000690" class="method-signature">
          <span class="method-name">count</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the number of records in the dataset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000690-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000690-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 82</span>
82:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">count</span>
83:       <span class="ruby-identifier">options_overlap</span>(<span class="ruby-constant">COUNT_FROM_SELF_OPTS</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">from_self</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">clone</span>(<span class="ruby-constant">STOCK_COUNT_OPTS</span>).<span class="ruby-identifier">single_value</span>.<span class="ruby-identifier">to_i</span>
84:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000750" class="method-detail">
        <a name="M000750"></a>

        <div class="method-heading">
          <a href="#M000750" class="method-signature">
          <span class="method-name">def_mutation_method</span><span class="method-args">(*meths)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add a mutation method to this dataset instance.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000750-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000750-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 163</span>
163:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">def_mutation_method</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">meths</span>)
164:       <span class="ruby-identifier">meths</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">meth</span><span class="ruby-operator">|</span>
165:         <span class="ruby-identifier">instance_eval</span>(<span class="ruby-node">&quot;def #{meth}!(*args, &amp;block); mutation_method(:#{meth}, *args, &amp;block) end&quot;</span>)
166:       <span class="ruby-keyword kw">end</span>
167:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000751" class="method-detail">
        <a name="M000751"></a>

        <div class="method-heading">
          <a href="#M000751" class="method-signature">
          <span class="method-name">delete</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Deletes the records in the dataset. The returned value is generally the
number of records deleted, but that is adapter dependent.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000751-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000751-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 171</span>
171:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete</span>
172:       <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">delete_sql</span>)
173:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000691" class="method-detail">
        <a name="M000691"></a>

        <div class="method-heading">
          <a href="#M000691" class="method-signature">
          <span class="method-name">delete_sql</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Formats a DELETE statement using the given options <a
href="Dataset.html#M000683">and</a> dataset options.
</p>
<pre>
  dataset.filter{|o| o.price &gt;= 100}.delete_sql #=&gt;
    &quot;DELETE FROM items WHERE (price &gt;= 100)&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000691-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000691-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 90</span>
 90:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete_sql</span>
 91:       <span class="ruby-identifier">opts</span> = <span class="ruby-ivar">@opts</span>
 92: 
 93:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">static_sql</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:sql</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:sql</span>]
 94: 
 95:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:group</span>]
 96:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidOperation</span>, <span class="ruby-value str">&quot;Grouped datasets cannot be deleted from&quot;</span>
 97:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
 98:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidOperation</span>, <span class="ruby-value str">&quot;Joined datasets cannot be deleted from&quot;</span>
 99:       <span class="ruby-keyword kw">end</span>
100: 
101:       <span class="ruby-identifier">sql</span> = <span class="ruby-node">&quot;DELETE FROM #{source_list(opts[:from])}&quot;</span>
102: 
103:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">where</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:where</span>]
104:         <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; WHERE #{literal(where)}&quot;</span>
105:       <span class="ruby-keyword kw">end</span>
106: 
107:       <span class="ruby-identifier">sql</span>
108:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000692" class="method-detail">
        <a name="M000692"></a>

        <div class="method-heading">
          <a href="#M000692" class="method-signature">
          <span class="method-name">distinct</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the <a href="SQL.html">SQL</a> DISTINCT
clause. The DISTINCT clause is used to remove duplicate rows <a
href="Dataset.html#M000698">from</a> the output. If arguments are provided,
uses a DISTINCT ON clause, in which case it will only be <a
href="Dataset.html#M000692">distinct</a> on those <a
href="Dataset.html#M000748">columns</a>, instead of <a
href="Dataset.html#M000746">all</a> returned <a
href="Dataset.html#M000748">columns</a>.
</p>
<pre>
 dataset.distinct # SQL: SELECT DISTINCT * FROM items
 dataset.order(:id).distinct(:id) # SQL: SELECT DISTINCT ON (id) * FROM items ORDER BY id
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000692-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000692-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 118</span>
118:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">distinct</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
119:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:distinct</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">args</span>)
120:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000752" class="method-detail">
        <a name="M000752"></a>

        <div class="method-heading">
          <a href="#M000752" class="method-signature">
          <span class="method-name">each</span><span class="method-args">() {|row_proc.call(r)}| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Iterates over the records in the dataset <a
href="Dataset.html#M000745">as</a> they are yielded <a
href="Dataset.html#M000698">from</a> the database adapter, <a
href="Dataset.html#M000683">and</a> returns self.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000752-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000752-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 177</span>
177:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
178:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:graph</span>]
179:         <span class="ruby-identifier">graph_each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
180:       <span class="ruby-keyword kw">else</span>
181:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">row_proc</span> = <span class="ruby-ivar">@row_proc</span>
182:           <span class="ruby-identifier">fetch_rows</span>(<span class="ruby-identifier">select_sql</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">row_proc</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">r</span>)}
183:         <span class="ruby-keyword kw">else</span>
184:           <span class="ruby-identifier">fetch_rows</span>(<span class="ruby-identifier">select_sql</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
185:         <span class="ruby-keyword kw">end</span>
186:       <span class="ruby-keyword kw">end</span>
187:       <span class="ruby-keyword kw">self</span>
188:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000765" class="method-detail">
        <a name="M000765"></a>

        <div class="method-heading">
          <a href="#M000765" class="method-signature">
          <span class="method-name">each_page</span><span class="method-args">(page_size) {|paginate(page_no, page_size, record_count)}| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Yields a paginated dataset for <a href="Dataset.html#M000752">each</a> page
<a href="Dataset.html#M000683">and</a> returns the receiver. Does a <a
href="Dataset.html#M000690">count</a> to find the total number of records
for this dataset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000765-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000765-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/extensions/pagination.rb, line 16</span>
16:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_page</span>(<span class="ruby-identifier">page_size</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
17:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;You cannot paginate a dataset that already has a limit&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:limit</span>]
18:       <span class="ruby-identifier">record_count</span> = <span class="ruby-identifier">count</span>
19:       <span class="ruby-identifier">total_pages</span> = (<span class="ruby-identifier">record_count</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">page_size</span>.<span class="ruby-identifier">to_f</span>).<span class="ruby-identifier">ceil</span>
20:       (<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-identifier">total_pages</span>).<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">page_no</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">paginate</span>(<span class="ruby-identifier">page_no</span>, <span class="ruby-identifier">page_size</span>, <span class="ruby-identifier">record_count</span>)}
21:       <span class="ruby-keyword kw">self</span>
22:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000659" class="method-detail">
        <a name="M000659"></a>

        <div class="method-heading">
          <a href="#M000659" class="method-signature">
          <span class="method-name">empty?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if no records exist in the dataset, false otherwise
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000659-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000659-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 32</span>
32:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty?</span>
33:       <span class="ruby-identifier">get</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">nil?</span>
34:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000693" class="method-detail">
        <a name="M000693"></a>

        <div class="method-heading">
          <a href="#M000693" class="method-signature">
          <span class="method-name">except</span><span class="method-args">(dataset, all = false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds an EXCEPT clause using a second dataset object. If <a
href="Dataset.html#M000746">all</a> is true the clause used is EXCEPT ALL,
which may return duplicate rows.
</p>
<pre>
  DB[:items].except(DB[:other_items]).sql
  #=&gt; &quot;SELECT * FROM items EXCEPT SELECT * FROM other_items&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000693-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000693-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 127</span>
127:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">except</span>(<span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">all</span> = <span class="ruby-keyword kw">false</span>)
128:       <span class="ruby-identifier">compound_clone</span>(<span class="ruby-identifier">:except</span>, <span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">all</span>)
129:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000694" class="method-detail">
        <a name="M000694"></a>

        <div class="method-heading">
          <a href="#M000694" class="method-signature">
          <span class="method-name">exclude</span><span class="method-args">(*cond, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Performs the inverse of <a href="Dataset.html#M000696">Dataset#filter</a>.
</p>
<pre>
  dataset.exclude(:category =&gt; 'software').sql #=&gt;
    &quot;SELECT * FROM items WHERE (category != 'software')&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000694-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000694-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 135</span>
135:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exclude</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
136:       <span class="ruby-identifier">clause</span> = (<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:having</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">:having</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">:where</span>)
137:       <span class="ruby-identifier">cond</span> = <span class="ruby-identifier">cond</span>.<span class="ruby-identifier">first</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cond</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
138:       <span class="ruby-identifier">cond</span> = <span class="ruby-identifier">filter_expr</span>(<span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
139:       <span class="ruby-identifier">cond</span> = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">invert</span>(<span class="ruby-identifier">cond</span>)
140:       <span class="ruby-identifier">cond</span> = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:AND</span>, <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">clause</span>], <span class="ruby-identifier">cond</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">clause</span>]
141:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">clause</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">cond</span>)
142:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000695" class="method-detail">
        <a name="M000695"></a>

        <div class="method-heading">
          <a href="#M000695" class="method-signature">
          <span class="method-name">exists</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an EXISTS clause for the dataset <a
href="Dataset.html#M000745">as</a> a <a
href="LiteralString.html">LiteralString</a>.
</p>
<pre>
  DB.select(1).where(DB[:items].exists).sql
  #=&gt; &quot;SELECT 1 WHERE EXISTS (SELECT * FROM items)&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000695-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000695-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 148</span>
148:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exists</span>
149:       <span class="ruby-constant">LiteralString</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;EXISTS (#{select_sql})&quot;</span>)
150:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000753" class="method-detail">
        <a name="M000753"></a>

        <div class="method-heading">
          <a href="#M000753" class="method-signature">
          <span class="method-name">fetch_rows</span><span class="method-args">(sql, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Executes a <a href="Dataset.html#M000729">select</a> <a
href="Dataset.html#M000767">query</a> <a
href="Dataset.html#M000683">and</a> fetches records, passing <a
href="Dataset.html#M000752">each</a> record to the supplied block. The
yielded records should be hashes with symbol keys.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000753-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000753-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 192</span>
192:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fetch_rows</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
193:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-constant">NOTIMPL_MSG</span>
194:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000654" class="method-detail">
        <a name="M000654"></a>

        <div class="method-heading">
          <a href="#M000654" class="method-signature">
          <span class="method-name">fetch_rows</span><span class="method-args">(sql, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Correctly return rows <a href="Dataset.html#M000698">from</a> the database
<a href="Dataset.html#M000683">and</a> return them <a
href="Dataset.html#M000745">as</a> hashes.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000654-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000654-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/adapters/jdbc.rb, line 430</span>
430:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fetch_rows</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
431:         <span class="ruby-identifier">execute</span>(<span class="ruby-identifier">sql</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">result</span><span class="ruby-operator">|</span> <span class="ruby-identifier">process_result_set</span>(<span class="ruby-identifier">result</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)}
432:         <span class="ruby-keyword kw">self</span>
433:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000653" class="method-detail">
        <a name="M000653"></a>

        <div class="method-heading">
          <a href="#M000653" class="method-signature">
          <span class="method-name">fetch_rows</span><span class="method-args">(sql) {|h| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Execute the <a href="SQL.html">SQL</a> on the database <a
href="Dataset.html#M000683">and</a> yield the rows <a
href="Dataset.html#M000745">as</a> hashes with symbol keys.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000653-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000653-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/adapters/do.rb, line 180</span>
180:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fetch_rows</span>(<span class="ruby-identifier">sql</span>)
181:         <span class="ruby-identifier">execute</span>(<span class="ruby-identifier">sql</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">reader</span><span class="ruby-operator">|</span>
182:           <span class="ruby-identifier">cols</span> = <span class="ruby-ivar">@columns</span> = <span class="ruby-identifier">reader</span>.<span class="ruby-identifier">fields</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">output_identifier</span>(<span class="ruby-identifier">f</span>)}
183:           <span class="ruby-keyword kw">while</span>(<span class="ruby-identifier">reader</span>.<span class="ruby-identifier">next!</span>) <span class="ruby-keyword kw">do</span>
184:             <span class="ruby-identifier">h</span> = {}
185:             <span class="ruby-identifier">cols</span>.<span class="ruby-identifier">zip</span>(<span class="ruby-identifier">reader</span>.<span class="ruby-identifier">values</span>).<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span>}
186:             <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">h</span>
187:           <span class="ruby-keyword kw">end</span>
188:         <span class="ruby-keyword kw">end</span>
189:         <span class="ruby-keyword kw">self</span>
190:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000696" class="method-detail">
        <a name="M000696"></a>

        <div class="method-heading">
          <a href="#M000696" class="method-signature">
          <span class="method-name">filter</span><span class="method-args">(*cond, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the given conditions imposed upon it. If
the <a href="Dataset.html#M000767">query</a> already has a HAVING clause,
then the conditions are imposed in the HAVING clause. If not, then they are
imposed in the WHERE clause.
</p>
<p>
<a href="Dataset.html#M000696">filter</a> accepts the following argument
types:
</p>
<ul>
<li><a href="../Hash.html">Hash</a> - list of equality/inclusion expressions

</li>
<li><a href="../Array.html">Array</a> - depends:

<ul>
<li>If <a href="Dataset.html#M000660">first</a> member is a string, assumes the
rest of the arguments are parameters <a href="Dataset.html#M000683">and</a>
interpolates them into the string.

</li>
<li>If <a href="Dataset.html#M000746">all</a> members are arrays of length two,
treats the same way <a href="Dataset.html#M000745">as</a> a hash, <a
href="Dataset.html#M000693">except</a> it allows for duplicate keys to be
specified.

</li>
</ul>
</li>
<li><a href="../String.html">String</a> - taken literally

</li>
<li><a href="../Symbol.html">Symbol</a> - taken <a
href="Dataset.html#M000745">as</a> a boolean column argument (e.g. WHERE
active)

</li>
<li><a href="SQL/BooleanExpression.html">Sequel::SQL::BooleanExpression</a> -
an existing condition expression, probably created using the <a
href="../Sequel.html">Sequel</a> expression <a
href="Dataset.html#M000696">filter</a> DSL.

</li>
</ul>
<p>
<a href="Dataset.html#M000696">filter</a> also takes a block, which should
return one of the above argument types, <a
href="Dataset.html#M000683">and</a> is treated the same way. This block
yields a virtual row object, which is easy to use to create identifiers <a
href="Dataset.html#M000683">and</a> functions.
</p>
<p>
If both a block <a href="Dataset.html#M000683">and</a> regular argument are
provided, they <a href="Dataset.html#M000661">get</a> ANDed together.
</p>
<p>
Examples:
</p>
<pre>
  dataset.filter(:id =&gt; 3).sql #=&gt;
    &quot;SELECT * FROM items WHERE (id = 3)&quot;
  dataset.filter('price &lt; ?', 100).sql #=&gt;
    &quot;SELECT * FROM items WHERE price &lt; 100&quot;
  dataset.filter([[:id, (1,2,3)], [:id, 0..10]]).sql #=&gt;
    &quot;SELECT * FROM items WHERE ((id IN (1, 2, 3)) AND ((id &gt;= 0) AND (id &lt;= 10)))&quot;
  dataset.filter('price &lt; 100').sql #=&gt;
    &quot;SELECT * FROM items WHERE price &lt; 100&quot;
  dataset.filter(:active).sql #=&gt;
    &quot;SELECT * FROM items WHERE :active
  dataset.filter{|o| o.price &lt; 100}.sql #=&gt;
    &quot;SELECT * FROM items WHERE (price &lt; 100)&quot;
</pre>
<p>
Multiple <a href="Dataset.html#M000696">filter</a> calls can be chained for
scoping:
</p>
<pre>
  software = dataset.filter(:category =&gt; 'software')
  software.filter{|o| o.price &lt; 100}.sql #=&gt;
    &quot;SELECT * FROM items WHERE ((category = 'software') AND (price &lt; 100))&quot;
</pre>
<p>
See doc/dataset_filters.rdoc for more examples <a
href="Dataset.html#M000683">and</a> details.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000696-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000696-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 199</span>
199:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">filter</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
200:       <span class="ruby-identifier">_filter</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:having</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">:having</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">:where</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
201:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000660" class="method-detail">
        <a name="M000660"></a>

        <div class="method-heading">
          <a href="#M000660" class="method-signature">
          <span class="method-name">first</span><span class="method-args">(*args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
If a integer argument is given, it is interpreted <a
href="Dataset.html#M000745">as</a> a <a
href="Dataset.html#M000713">limit</a>, <a
href="Dataset.html#M000683">and</a> then returns <a
href="Dataset.html#M000746">all</a> matching records up to that <a
href="Dataset.html#M000713">limit</a>. If no argument is passed, it returns
the <a href="Dataset.html#M000660">first</a> matching record. If any other
type of argument(s) is passed, it is given to <a
href="Dataset.html#M000696">filter</a> <a
href="Dataset.html#M000683">and</a> the <a
href="Dataset.html#M000660">first</a> matching record is returned. If a
block is given, it is used to <a href="Dataset.html#M000696">filter</a> the
dataset before returning anything. Examples:
</p>
<pre>
  ds.first =&gt; {:id=&gt;7}
  ds.first(2) =&gt; [{:id=&gt;6}, {:id=&gt;4}]
  ds.order(:id).first(2) =&gt; [{:id=&gt;1}, {:id=&gt;2}]
  ds.first(:id=&gt;2) =&gt; {:id=&gt;2}
  ds.first(&quot;id = 3&quot;) =&gt; {:id=&gt;3}
  ds.first(&quot;id = ?&quot;, 4) =&gt; {:id=&gt;4}
  ds.first{|o| o.id &gt; 2} =&gt; {:id=&gt;5}
  ds.order(:id).first{|o| o.id &gt; 2} =&gt; {:id=&gt;3}
  ds.first{|o| o.id &gt; 2} =&gt; {:id=&gt;5}
  ds.first(&quot;id &gt; ?&quot;, 4){|o| o.id &lt; 6} =&gt; {:id=&gt;5}
  ds.order(:id).first(2){|o| o.id &lt; 2} =&gt; [{:id=&gt;1}]
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000660-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000660-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 55</span>
55:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">first</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
56:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">block</span> <span class="ruby-value">? </span><span class="ruby-identifier">filter</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>
57: 
58:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
59:         <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">single_record</span>
60:       <span class="ruby-keyword kw">else</span>
61:         <span class="ruby-identifier">args</span> = (<span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">args</span>
62:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Integer</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">args</span>
63:           <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">limit</span>(<span class="ruby-identifier">args</span>).<span class="ruby-identifier">all</span>
64:         <span class="ruby-keyword kw">else</span>
65:           <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">args</span>).<span class="ruby-identifier">single_record</span>
66:         <span class="ruby-keyword kw">end</span>
67:       <span class="ruby-keyword kw">end</span>
68:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000697" class="method-detail">
        <a name="M000697"></a>

        <div class="method-heading">
          <a href="#M000697" class="method-signature">
          <span class="method-name">first_source</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The <a href="Dataset.html#M000660">first</a> source (primary table) for
this dataset. If the dataset doesn&#8216;t have a table, raises an error.
If the table is aliased, returns the aliased name.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000697-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000697-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 205</span>
205:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">first_source</span>
206:       <span class="ruby-identifier">source</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:from</span>]
207:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">empty?</span>
208:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-value str">'No source specified for query'</span>
209:       <span class="ruby-keyword kw">end</span>
210:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">s</span> = <span class="ruby-identifier">source</span>.<span class="ruby-identifier">first</span>
211:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>
212:         <span class="ruby-identifier">s</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">first</span>
213:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
214:         <span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">aliaz</span> = <span class="ruby-identifier">split_symbol</span>(<span class="ruby-identifier">s</span>)
215:         <span class="ruby-identifier">aliaz</span> <span class="ruby-value">? </span><span class="ruby-identifier">aliaz</span>.<span class="ruby-identifier">to_sym</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">s</span>
216:       <span class="ruby-keyword kw">else</span>
217:         <span class="ruby-identifier">s</span>
218:       <span class="ruby-keyword kw">end</span>
219:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000698" class="method-detail">
        <a name="M000698"></a>

        <div class="method-heading">
          <a href="#M000698" class="method-signature">
          <span class="method-name">from</span><span class="method-args">(*source)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the source changed.
</p>
<pre>
  dataset.from # SQL: SELECT *
  dataset.from(:blah) # SQL: SELECT * FROM blah
  dataset.from(:blah, :foo) # SQL: SELECT * FROM blah, foo
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000698-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000698-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 226</span>
226:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">from</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">source</span>)
227:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:from=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">source</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">source</span>)
228:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000699" class="method-detail">
        <a name="M000699"></a>

        <div class="method-heading">
          <a href="#M000699" class="method-signature">
          <span class="method-name">from_self</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a dataset selecting <a href="Dataset.html#M000698">from</a> the
current dataset.
</p>
<pre>
  ds = DB[:items].order(:name)
  ds.sql #=&gt; &quot;SELECT * FROM items ORDER BY name&quot;
  ds.from_self.sql #=&gt; &quot;SELECT * FROM (SELECT * FROM items ORDER BY name)&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000699-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000699-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 235</span>
235:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">from_self</span>
236:       <span class="ruby-identifier">fs</span> = {}
237:       <span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">fs</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-keyword kw">nil</span>} 
238:       <span class="ruby-identifier">fs</span>[<span class="ruby-identifier">:from</span>] = [<span class="ruby-keyword kw">self</span>]
239:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">fs</span>)
240:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000700" class="method-detail">
        <a name="M000700"></a>

        <div class="method-heading">
          <a href="#M000700" class="method-signature">
          <span class="method-name">function_sql</span><span class="method-args">(f)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment specifying an <a
href="SQL.html">SQL</a> function <a href="Dataset.html#M000680">call</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000700-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000700-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 243</span>
243:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">function_sql</span>(<span class="ruby-identifier">f</span>)
244:       <span class="ruby-identifier">args</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">args</span>
245:       <span class="ruby-node">&quot;#{f.f}#{args.empty? ? '()' : literal(args)}&quot;</span>
246:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000661" class="method-detail">
        <a name="M000661"></a>

        <div class="method-heading">
          <a href="#M000661" class="method-signature">
          <span class="method-name">get</span><span class="method-args">(column=nil, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return the column value for the <a href="Dataset.html#M000660">first</a>
matching record in the dataset. Raises an error if both an argument <a
href="Dataset.html#M000683">and</a> block is given.
</p>
<pre>
  ds.get(:id)
  ds.get{|o| o.sum(:id)}
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000661-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000661-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 75</span>
75:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
76:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">column</span>
77:         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-constant">GET_ERROR_MSG</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
78:         <span class="ruby-identifier">select</span>(<span class="ruby-identifier">column</span>).<span class="ruby-identifier">single_value</span>
79:       <span class="ruby-keyword kw">else</span>
80:         <span class="ruby-identifier">select</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>).<span class="ruby-identifier">single_value</span>
81:       <span class="ruby-keyword kw">end</span>
82:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000677" class="method-detail">
        <a name="M000677"></a>

        <div class="method-heading">
          <a href="#M000677" class="method-signature">
          <span class="method-name">graph</span><span class="method-args">(dataset, join_conditions = nil, options = {}, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Allows you to join multiple datasets/tables <a
href="Dataset.html#M000683">and</a> have the result <a
href="Dataset.html#M000759">set</a> split into component tables.
</p>
<p>
This differs <a href="Dataset.html#M000698">from</a> the usual usage of
join, which returns the result <a href="Dataset.html#M000759">set</a> <a
href="Dataset.html#M000745">as</a> a single hash. For example:
</p>
<pre>
  # CREATE TABLE artists (id INTEGER, name TEXT);
  # CREATE TABLE albums (id INTEGER, name TEXT, artist_id INTEGER);
  DB[:artists].left_outer_join(:albums, :artist_id=&gt;:id).first
  =&gt; {:id=&gt;albums.id, :name=&gt;albums.name, :artist_id=&gt;albums.artist_id}
  DB[:artists].graph(:albums, :artist_id=&gt;:id).first
  =&gt; {:artists=&gt;{:id=&gt;artists.id, :name=&gt;artists.name}, :albums=&gt;{:id=&gt;albums.id, :name=&gt;albums.name, :artist_id=&gt;albums.artist_id}}
</pre>
<p>
Using a join such <a href="Dataset.html#M000745">as</a> left_outer_join,
the attribute names that are shared between the tables are combined in the
single return hash. You can <a href="Dataset.html#M000661">get</a> around
that by using .<a href="Dataset.html#M000729">select</a> with correct
aliases for <a href="Dataset.html#M000746">all</a> of the <a
href="Dataset.html#M000748">columns</a>, but it is simpler to use <a
href="Dataset.html#M000677">graph</a> <a
href="Dataset.html#M000683">and</a> have the result <a
href="Dataset.html#M000759">set</a> split for you. In addition, <a
href="Dataset.html#M000677">graph</a> respects any row_proc of the current
dataset <a href="Dataset.html#M000683">and</a> the datasets you use with <a
href="Dataset.html#M000677">graph</a>.
</p>
<p>
If you are graphing a table <a href="Dataset.html#M000683">and</a> <a
href="Dataset.html#M000746">all</a> <a
href="Dataset.html#M000748">columns</a> for that table are nil, this
indicates that no matching rows existed in the table, so <a
href="Dataset.html#M000677">graph</a> will return nil instead of a hash
with <a href="Dataset.html#M000746">all</a> nil values:
</p>
<pre>
  # If the artist doesn't have any albums
  DB[:artists].graph(:albums, :artist_id=&gt;:id).first
  =&gt; {:artists=&gt;{:id=&gt;artists.id, :name=&gt;artists.name}, :albums=&gt;nil}
</pre>
<p>
Arguments:
</p>
<ul>
<li>dataset - Can be a symbol (specifying a table), another dataset, <a
href="Dataset.html#M000716">or</a> an object that responds to .dataset <a
href="Dataset.html#M000683">and</a> return a symbol <a
href="Dataset.html#M000716">or</a> a dataset

</li>
<li>join_conditions - Any condition(s) allowed by <a
href="Dataset.html#M000712">join_table</a>.

</li>
<li>options - A hash of <a href="Dataset.html#M000677">graph</a> options. The
following options are currently used:

<ul>
<li>:implicit_qualifier - The qualifier of implicit conditions, see <a
href="Dataset.html#M000712">join_table</a>.

</li>
<li>:join_type - The type of join to use (passed to <a
href="Dataset.html#M000712">join_table</a>). Defaults to :left_outer.

</li>
<li>:<a href="Dataset.html#M000729">select</a> - An array of <a
href="Dataset.html#M000748">columns</a> to <a
href="Dataset.html#M000729">select</a>. When not used, selects <a
href="Dataset.html#M000746">all</a> <a
href="Dataset.html#M000748">columns</a> in the given dataset. When <a
href="Dataset.html#M000759">set</a> to false, selects no <a
href="Dataset.html#M000748">columns</a> <a
href="Dataset.html#M000683">and</a> is like simply joining the tables,
though <a href="Dataset.html#M000677">graph</a> keeps some metadata about
join that makes it important to use <a
href="Dataset.html#M000677">graph</a> instead of join.

</li>
<li>:table_alias - The alias to use for the table. If not specified,
doesn&#8216;t alias the table. You will <a
href="Dataset.html#M000661">get</a> an error if the the alias (<a
href="Dataset.html#M000716">or</a> table) name is used more than once.

</li>
</ul>
</li>
<li>block - A block that is passed to <a
href="Dataset.html#M000712">join_table</a>.

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000677-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000677-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/graph.rb, line 47</span>
 47:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">graph</span>(<span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">join_conditions</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
 48:       <span class="ruby-comment cmt"># Allow the use of a model, dataset, or symbol as the first argument</span>
 49:       <span class="ruby-comment cmt"># Find the table name/dataset based on the argument</span>
 50:       <span class="ruby-identifier">dataset</span> = <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">dataset</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:dataset</span>)
 51:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">dataset</span>
 52:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
 53:         <span class="ruby-identifier">table</span> = <span class="ruby-identifier">dataset</span>
 54:         <span class="ruby-identifier">dataset</span> = <span class="ruby-ivar">@db</span>[<span class="ruby-identifier">dataset</span>]
 55:       <span class="ruby-keyword kw">when</span> <span class="ruby-operator">::</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Dataset</span>
 56:         <span class="ruby-identifier">table</span> = <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">first_source</span>
 57:       <span class="ruby-keyword kw">else</span>
 58:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;The dataset argument should be a symbol, dataset, or model&quot;</span>
 59:       <span class="ruby-keyword kw">end</span>
 60: 
 61:       <span class="ruby-comment cmt"># Raise Sequel::Error with explanation that the table alias has been used</span>
 62:       <span class="ruby-identifier">raise_alias_error</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword kw">do</span>
 63:         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;this #{options[:table_alias] ? 'alias' : 'table'} has already been been used, please specify &quot;</span> \
 64:           <span class="ruby-node">&quot;#{options[:table_alias] ? 'a different alias' : 'an alias via the :table_alias option'}&quot;</span>) 
 65:       <span class="ruby-keyword kw">end</span>
 66: 
 67:       <span class="ruby-comment cmt"># Only allow table aliases that haven't been used</span>
 68:       <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:table_alias</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">table</span>
 69:       <span class="ruby-identifier">raise_alias_error</span>.<span class="ruby-identifier">call</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:graph</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:graph</span>][<span class="ruby-identifier">:table_aliases</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:graph</span>][<span class="ruby-identifier">:table_aliases</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">table_alias</span>)
 70: 
 71:       <span class="ruby-comment cmt"># Join the table early in order to avoid cloning the dataset twice</span>
 72:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">join_table</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:join_type</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">:left_outer</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">join_conditions</span>, <span class="ruby-identifier">:table_alias=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">table_alias</span>, <span class="ruby-identifier">:implicit_qualifier=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">options</span>[<span class="ruby-identifier">:implicit_qualifier</span>], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
 73:       <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">opts</span>
 74: 
 75:       <span class="ruby-comment cmt"># Whether to include the table in the result set</span>
 76:       <span class="ruby-identifier">add_table</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:select</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">false</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">true</span>
 77:       <span class="ruby-comment cmt"># Whether to add the columns to the list of column aliases</span>
 78:       <span class="ruby-identifier">add_columns</span> = <span class="ruby-operator">!</span><span class="ruby-identifier">ds</span>.<span class="ruby-identifier">opts</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:graph_aliases</span>)
 79: 
 80:       <span class="ruby-comment cmt"># Setup the initial graph data structure if it doesn't exist</span>
 81:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">graph</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:graph</span>]
 82:         <span class="ruby-identifier">master</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">first_source</span>
 83:         <span class="ruby-identifier">raise_alias_error</span>.<span class="ruby-identifier">call</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">master</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">table_alias</span>
 84:         <span class="ruby-comment cmt"># Master hash storing all .graph related information</span>
 85:         <span class="ruby-identifier">graph</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:graph</span>] = {}
 86:         <span class="ruby-comment cmt"># Associates column aliases back to tables and columns</span>
 87:         <span class="ruby-identifier">column_aliases</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">:column_aliases</span>] = {}
 88:         <span class="ruby-comment cmt"># Associates table alias (the master is never aliased)</span>
 89:         <span class="ruby-identifier">table_aliases</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">:table_aliases</span>] = {<span class="ruby-identifier">master</span>=<span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">self</span>}
 90:         <span class="ruby-comment cmt"># Keep track of the alias numbers used</span>
 91:         <span class="ruby-identifier">ca_num</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">:column_alias_num</span>] = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">0</span>)
 92:         <span class="ruby-comment cmt"># All columns in the master table are never</span>
 93:         <span class="ruby-comment cmt"># aliased, but are not included if set_graph_aliases</span>
 94:         <span class="ruby-comment cmt"># has been used.</span>
 95:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">add_columns</span>
 96:           <span class="ruby-identifier">select</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:select</span>] = []
 97:           <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span>
 98:             <span class="ruby-identifier">column_aliases</span>[<span class="ruby-identifier">column</span>] = [<span class="ruby-identifier">master</span>, <span class="ruby-identifier">column</span>]
 99:             <span class="ruby-identifier">select</span>.<span class="ruby-identifier">push</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">master</span>, <span class="ruby-identifier">column</span>))
100:           <span class="ruby-keyword kw">end</span>
101:         <span class="ruby-keyword kw">end</span>
102:       <span class="ruby-keyword kw">end</span>
103: 
104:       <span class="ruby-comment cmt"># Add the table alias to the list of aliases</span>
105:       <span class="ruby-comment cmt"># Even if it isn't been used in the result set,</span>
106:       <span class="ruby-comment cmt"># we add a key for it with a nil value so we can check if it</span>
107:       <span class="ruby-comment cmt"># is used more than once</span>
108:       <span class="ruby-identifier">table_aliases</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">:table_aliases</span>]
109:       <span class="ruby-identifier">table_aliases</span>[<span class="ruby-identifier">table_alias</span>] = <span class="ruby-identifier">add_table</span> <span class="ruby-value">? </span><span class="ruby-identifier">dataset</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
110: 
111:       <span class="ruby-comment cmt"># Add the columns to the selection unless we are ignoring them</span>
112:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">add_table</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">add_columns</span>
113:         <span class="ruby-identifier">select</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:select</span>]
114:         <span class="ruby-identifier">column_aliases</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">:column_aliases</span>]
115:         <span class="ruby-identifier">ca_num</span> = <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">:column_alias_num</span>]
116:         <span class="ruby-comment cmt"># Which columns to add to the result set</span>
117:         <span class="ruby-identifier">cols</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:select</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">columns</span>
118:         <span class="ruby-comment cmt"># If the column hasn't been used yet, don't alias it.</span>
119:         <span class="ruby-comment cmt"># If it has been used, try table_column.</span>
120:         <span class="ruby-comment cmt"># If that has been used, try table_column_N </span>
121:         <span class="ruby-comment cmt"># using the next value of N that we know hasn't been</span>
122:         <span class="ruby-comment cmt"># used</span>
123:         <span class="ruby-identifier">cols</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span>
124:           <span class="ruby-identifier">col_alias</span>, <span class="ruby-identifier">identifier</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">column_aliases</span>[<span class="ruby-identifier">column</span>]
125:             <span class="ruby-identifier">column_alias</span> = <span class="ruby-node">&quot;#{table_alias}_#{column}&quot;</span><span class="ruby-node">&quot;#{table_alias}_#{column}&quot;</span>
126:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">column_aliases</span>[<span class="ruby-identifier">column_alias</span>]
127:               <span class="ruby-identifier">column_alias_num</span> = <span class="ruby-identifier">ca_num</span>[<span class="ruby-identifier">column_alias</span>]
128:               <span class="ruby-identifier">column_alias</span> = <span class="ruby-node">&quot;#{column_alias}_#{column_alias_num}&quot;</span><span class="ruby-node">&quot;#{column_alias}_#{column_alias_num}&quot;</span> 
129:               <span class="ruby-identifier">ca_num</span>[<span class="ruby-identifier">column_alias</span>] <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
130:             <span class="ruby-keyword kw">end</span>
131:             [<span class="ruby-identifier">column_alias</span>, <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">table_alias</span>, <span class="ruby-identifier">column</span>).<span class="ruby-identifier">as</span>(<span class="ruby-identifier">column_alias</span>)]
132:           <span class="ruby-keyword kw">else</span>
133:             [<span class="ruby-identifier">column</span>, <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">table_alias</span>, <span class="ruby-identifier">column</span>)]
134:           <span class="ruby-keyword kw">end</span>
135:           <span class="ruby-identifier">column_aliases</span>[<span class="ruby-identifier">col_alias</span>] = [<span class="ruby-identifier">table_alias</span>, <span class="ruby-identifier">column</span>]
136:           <span class="ruby-identifier">select</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">identifier</span>)
137:         <span class="ruby-keyword kw">end</span>
138:       <span class="ruby-keyword kw">end</span>
139:       <span class="ruby-identifier">ds</span>
140:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000701" class="method-detail">
        <a name="M000701"></a>

        <div class="method-heading">
          <a href="#M000701" class="method-signature">
          <span class="method-name">grep</span><span class="method-args">(cols, terms)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Pattern match any of the <a href="Dataset.html#M000748">columns</a> to any
of the terms. The terms can be strings (which use LIKE) <a
href="Dataset.html#M000716">or</a> regular expressions (which are only
supported in some databases). See Sequel::SQL::StringExpression.like. Note
that the total number of pattern matches will be cols.length *
terms.length, which could cause performance issues.
</p>
<pre>
  dataset.grep(:a, '%test%') # SQL: SELECT * FROM items WHERE a LIKE '%test%'
  dataset.grep([:a, :b], %w'%test% foo') # SQL: SELECT * FROM items WHERE a LIKE '%test%' OR a LIKE 'foo' OR b LIKE '%test%' OR b LIKE 'foo'
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000701-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000701-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 256</span>
256:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">grep</span>(<span class="ruby-identifier">cols</span>, <span class="ruby-identifier">terms</span>)
257:       <span class="ruby-identifier">filter</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:OR</span>, <span class="ruby-operator">*</span><span class="ruby-constant">Array</span>(<span class="ruby-identifier">cols</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">StringExpression</span>.<span class="ruby-identifier">like</span>(<span class="ruby-identifier">c</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">terms</span>)}))
258:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000702" class="method-detail">
        <a name="M000702"></a>

        <div class="method-heading">
          <a href="#M000702" class="method-signature">
          <span class="method-name">group</span><span class="method-args">(*columns)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the results grouped by the value of the
given <a href="Dataset.html#M000748">columns</a>.
</p>
<pre>
  dataset.group(:id) # SELECT * FROM items GROUP BY id
  dataset.group(:id, :name) # SELECT * FROM items GROUP BY id, name
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000702-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000702-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 265</span>
265:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">group</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>)
266:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:group</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">columns</span>)
267:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000662" class="method-detail">
        <a name="M000662"></a>

        <div class="method-heading">
          <a href="#M000662" class="method-signature">
          <span class="method-name">group_and_count</span><span class="method-args">(*columns)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a dataset grouped by the given column with <a
href="Dataset.html#M000690">count</a> by <a
href="Dataset.html#M000702">group</a>, <a
href="Dataset.html#M000717">order</a> by the <a
href="Dataset.html#M000690">count</a> of records. Examples:
</p>
<pre>
  ds.group_and_count(:name) =&gt; [{:name=&gt;'a', :count=&gt;1}, ...]
  ds.group_and_count(:first_name, :last_name) =&gt; [{:first_name=&gt;'a', :last_name=&gt;'b', :count=&gt;1}, ...]
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000662-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000662-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 89</span>
89:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">group_and_count</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>)
90:       <span class="ruby-identifier">group</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>).<span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span>(<span class="ruby-identifier">columns</span> <span class="ruby-operator">+</span> [<span class="ruby-constant">COUNT_OF_ALL_AS_COUNT</span>])).<span class="ruby-identifier">order</span>(<span class="ruby-identifier">:count</span>)
91:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000703" class="method-detail">
        <a name="M000703"></a>

        <div class="method-heading">
          <span class="method-name">group_by</span><span class="method-args">(*columns)</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000702">group</a>
</p>
        </div>
      </div>

      <div id="method-M000704" class="method-detail">
        <a name="M000704"></a>

        <div class="method-heading">
          <a href="#M000704" class="method-signature">
          <span class="method-name">having</span><span class="method-args">(*cond, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the HAVING conditions changed. Raises an
error if the dataset has not been grouped. See <a
href="Dataset.html#M000696">filter</a> for argument types.
</p>
<pre>
  dataset.group(:sum).having(:sum=&gt;10) # SQL: SELECT * FROM items GROUP BY sum HAVING sum = 10
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000704-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000704-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 274</span>
274:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">having</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
275:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">InvalidOperation</span>, <span class="ruby-value str">&quot;Can only specify a HAVING clause on a grouped dataset&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:group</span>]
276:       <span class="ruby-identifier">_filter</span>(<span class="ruby-identifier">:having</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
277:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000663" class="method-detail">
        <a name="M000663"></a>

        <div class="method-heading">
          <a href="#M000663" class="method-signature">
          <span class="method-name">import</span><span class="method-args">(columns, values, opts={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Inserts multiple records into the associated table. This method can be to
efficiently <a href="Dataset.html#M000754">insert</a> a large amounts of
records into a table. Inserts are automatically wrapped in a transaction.
</p>
<p>
This method is called with a <a href="Dataset.html#M000748">columns</a>
array <a href="Dataset.html#M000683">and</a> an array of value arrays:
</p>
<pre>
  dataset.import([:x, :y], [[1, 2], [3, 4]])
</pre>
<p>
This method also accepts a dataset instead of an array of value arrays:
</p>
<pre>
  dataset.import([:x, :y], other_dataset.select(:a___x, :b___y))
</pre>
<p>
The method also accepts a :slice <a href="Dataset.html#M000716">or</a>
:commit_every option that specifies the number of records to <a
href="Dataset.html#M000754">insert</a> per transaction. This is useful
especially when inserting a large number of records, e.g.:
</p>
<pre>
  # this will commit every 50 records
  dataset.import([:x, :y], [[1, 2], [3, 4], ...], :slice =&gt; 50)
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000663-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000663-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 111</span>
111:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">import</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>, <span class="ruby-identifier">opts</span>={})
112:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">transaction</span>{<span class="ruby-identifier">execute_dui</span>(<span class="ruby-node">&quot;INSERT INTO #{quote_schema_table(@opts[:from].first)} (#{identifier_list(columns)}) VALUES #{literal(values)}&quot;</span>)} <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Dataset</span>)
113: 
114:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">empty?</span>
115:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-constant">IMPORT_ERROR_MSG</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">empty?</span>
116:       
117:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">slice_size</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:commit_every</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:slice</span>]
118:         <span class="ruby-identifier">offset</span> = <span class="ruby-value">0</span>
119:         <span class="ruby-identifier">loop</span> <span class="ruby-keyword kw">do</span>
120:           <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">transaction</span>(<span class="ruby-identifier">opts</span>){<span class="ruby-identifier">multi_insert_sql</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>[<span class="ruby-identifier">offset</span>, <span class="ruby-identifier">slice_size</span>]).<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">st</span><span class="ruby-operator">|</span> <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">st</span>)}}
121:           <span class="ruby-identifier">offset</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">slice_size</span>
122:           <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">offset</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">length</span>
123:         <span class="ruby-keyword kw">end</span>
124:       <span class="ruby-keyword kw">else</span>
125:         <span class="ruby-identifier">statements</span> = <span class="ruby-identifier">multi_insert_sql</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>)
126:         <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">transaction</span>{<span class="ruby-identifier">statements</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">st</span><span class="ruby-operator">|</span> <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">st</span>)}}
127:       <span class="ruby-keyword kw">end</span>
128:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000754" class="method-detail">
        <a name="M000754"></a>

        <div class="method-heading">
          <a href="#M000754" class="method-signature">
          <span class="method-name">insert</span><span class="method-args">(*values)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Inserts values into the associated table. The returned value is generally
the value of the primary key for the inserted row, but that is adapter
dependent.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000754-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000754-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 198</span>
198:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">insert</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">values</span>)
199:       <span class="ruby-identifier">execute_insert</span>(<span class="ruby-identifier">insert_sql</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">values</span>))
200:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000705" class="method-detail">
        <a name="M000705"></a>

        <div class="method-heading">
          <a href="#M000705" class="method-signature">
          <span class="method-name">insert_multiple</span><span class="method-args">(array, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Inserts multiple values. If a block is given it is invoked for <a
href="Dataset.html#M000752">each</a> item in the given array before
inserting it. See <a href="Dataset.html#M000669">multi_insert</a> <a
href="Dataset.html#M000745">as</a> a possible faster version that inserts
multiple records in one <a href="SQL.html">SQL</a> statement.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000705-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000705-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 283</span>
283:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">insert_multiple</span>(<span class="ruby-identifier">array</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
284:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
285:         <span class="ruby-identifier">array</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">insert</span>(<span class="ruby-identifier">block</span>[<span class="ruby-identifier">i</span>])}
286:       <span class="ruby-keyword kw">else</span>
287:         <span class="ruby-identifier">array</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">insert</span>(<span class="ruby-identifier">i</span>)}
288:       <span class="ruby-keyword kw">end</span>
289:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000706" class="method-detail">
        <a name="M000706"></a>

        <div class="method-heading">
          <a href="#M000706" class="method-signature">
          <span class="method-name">insert_sql</span><span class="method-args">(*values)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Formats an INSERT statement using the given values. If a hash is given, the
resulting statement includes column names. If no values are given, the
resulting statement includes a DEFAULT VALUES clause.
</p>
<pre>
  dataset.insert_sql #=&gt; 'INSERT INTO items DEFAULT VALUES'
  dataset.insert_sql(1,2,3) #=&gt; 'INSERT INTO items VALUES (1, 2, 3)'
  dataset.insert_sql(:a =&gt; 1, :b =&gt; 2) #=&gt;
    'INSERT INTO items (a, b) VALUES (1, 2)'
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000706-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000706-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 299</span>
299:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">insert_sql</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">values</span>)
300:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">static_sql</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:sql</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:sql</span>]
301: 
302:       <span class="ruby-identifier">from</span> = <span class="ruby-identifier">source_list</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:from</span>])
303:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">size</span>
304:       <span class="ruby-keyword kw">when</span> <span class="ruby-value">0</span>
305:         <span class="ruby-identifier">values</span> = {}
306:       <span class="ruby-keyword kw">when</span> <span class="ruby-value">1</span>
307:         <span class="ruby-identifier">vals</span> = <span class="ruby-identifier">values</span>.<span class="ruby-identifier">at</span>(<span class="ruby-value">0</span>)
308:         <span class="ruby-keyword kw">if</span> [<span class="ruby-constant">Hash</span>, <span class="ruby-constant">Dataset</span>, <span class="ruby-constant">Array</span>].<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-identifier">c</span>)}
309:           <span class="ruby-identifier">values</span> = <span class="ruby-identifier">vals</span>
310:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:values</span>)
311:           <span class="ruby-identifier">values</span> = <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">values</span>
312:         <span class="ruby-keyword kw">end</span>
313:       <span class="ruby-keyword kw">end</span>
314: 
315:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">values</span>
316:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
317:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">empty?</span>
318:           <span class="ruby-identifier">insert_default_values_sql</span>
319:         <span class="ruby-keyword kw">else</span>
320:           <span class="ruby-node">&quot;INSERT INTO #{from} VALUES #{literal(values)}&quot;</span>
321:         <span class="ruby-keyword kw">end</span>
322:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>
323:         <span class="ruby-identifier">values</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:defaults</span>].<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">values</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:defaults</span>]
324:         <span class="ruby-identifier">values</span> = <span class="ruby-identifier">values</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:overrides</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:overrides</span>]
325:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">empty?</span>
326:           <span class="ruby-identifier">insert_default_values_sql</span>
327:         <span class="ruby-keyword kw">else</span>
328:           <span class="ruby-identifier">fl</span>, <span class="ruby-identifier">vl</span> = [], []
329:           <span class="ruby-identifier">values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
330:             <span class="ruby-identifier">fl</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">literal</span>(<span class="ruby-constant">String</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">k</span> <span class="ruby-value">? </span><span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_sym</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">k</span>)
331:             <span class="ruby-identifier">vl</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">v</span>)
332:           <span class="ruby-keyword kw">end</span>
333:           <span class="ruby-node">&quot;INSERT INTO #{from} (#{fl.join(COMMA_SEPARATOR)}) VALUES (#{vl.join(COMMA_SEPARATOR)})&quot;</span>
334:         <span class="ruby-keyword kw">end</span>
335:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Dataset</span>
336:         <span class="ruby-node">&quot;INSERT INTO #{from} #{literal(values)}&quot;</span>
337:       <span class="ruby-keyword kw">end</span>
338:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000755" class="method-detail">
        <a name="M000755"></a>

        <div class="method-heading">
          <a href="#M000755" class="method-signature">
          <span class="method-name">inspect</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a string representation of the dataset including the class name <a
href="Dataset.html#M000683">and</a> the corresponding <a
href="SQL.html">SQL</a> <a href="Dataset.html#M000729">select</a>
statement.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000755-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000755-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 204</span>
204:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>
205:       <span class="ruby-node">&quot;#&lt;#{self.class}: #{sql.inspect}&gt;&quot;</span>
206:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000707" class="method-detail">
        <a name="M000707"></a>

        <div class="method-heading">
          <a href="#M000707" class="method-signature">
          <span class="method-name">intersect</span><span class="method-args">(dataset, all = false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds an INTERSECT clause using a second dataset object. If <a
href="Dataset.html#M000746">all</a> is true the clause used is INTERSECT
ALL, which may return duplicate rows.
</p>
<pre>
  DB[:items].intersect(DB[:other_items]).sql
  #=&gt; &quot;SELECT * FROM items INTERSECT SELECT * FROM other_items&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000707-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000707-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 345</span>
345:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">intersect</span>(<span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">all</span> = <span class="ruby-keyword kw">false</span>)
346:       <span class="ruby-identifier">compound_clone</span>(<span class="ruby-identifier">:intersect</span>, <span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">all</span>)
347:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000664" class="method-detail">
        <a name="M000664"></a>

        <div class="method-heading">
          <a href="#M000664" class="method-signature">
          <span class="method-name">interval</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Dataset.html#M000664">interval</a> between minimum <a
href="Dataset.html#M000683">and</a> maximum values for the given column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000664-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000664-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 132</span>
132:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">interval</span>(<span class="ruby-identifier">column</span>)
133:       <span class="ruby-identifier">get</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">max</span>(<span class="ruby-identifier">column</span>) <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">min</span>(<span class="ruby-identifier">column</span>)}
134:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000708" class="method-detail">
        <a name="M000708"></a>

        <div class="method-heading">
          <a href="#M000708" class="method-signature">
          <span class="method-name">invert</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Inverts the current <a href="Dataset.html#M000696">filter</a>
</p>
<pre>
  dataset.filter(:category =&gt; 'software').invert.sql #=&gt;
    &quot;SELECT * FROM items WHERE (category != 'software')&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000708-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000708-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 353</span>
353:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">invert</span>
354:       <span class="ruby-identifier">having</span>, <span class="ruby-identifier">where</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:having</span>], <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:where</span>]
355:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;No current filter&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">having</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">where</span>
356:       <span class="ruby-identifier">o</span> = {}
357:       <span class="ruby-identifier">o</span>[<span class="ruby-identifier">:having</span>] = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">invert</span>(<span class="ruby-identifier">having</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">having</span>
358:       <span class="ruby-identifier">o</span>[<span class="ruby-identifier">:where</span>] = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">invert</span>(<span class="ruby-identifier">where</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">where</span>
359:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">o</span>)
360:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000709" class="method-detail">
        <a name="M000709"></a>

        <div class="method-heading">
          <a href="#M000709" class="method-signature">
          <span class="method-name">join_clause_sql</span><span class="method-args">(jc)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment specifying a JOIN clause without ON <a
href="Dataset.html#M000716">or</a> USING.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000709-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000709-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 363</span>
363:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">join_clause_sql</span>(<span class="ruby-identifier">jc</span>)
364:       <span class="ruby-identifier">table</span> = <span class="ruby-identifier">jc</span>.<span class="ruby-identifier">table</span>
365:       <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">jc</span>.<span class="ruby-identifier">table_alias</span>
366:       <span class="ruby-identifier">table_alias</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">table</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">table_alias</span>
367:       <span class="ruby-identifier">tref</span> = <span class="ruby-identifier">table_ref</span>(<span class="ruby-identifier">table</span>)
368:       <span class="ruby-node">&quot; #{join_type_sql(jc.join_type)} #{table_alias ? as_sql(tref, table_alias) : tref}&quot;</span>
369:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000710" class="method-detail">
        <a name="M000710"></a>

        <div class="method-heading">
          <a href="#M000710" class="method-signature">
          <span class="method-name">join_on_clause_sql</span><span class="method-args">(jc)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment specifying a JOIN clause with ON.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000710-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000710-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 372</span>
372:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">join_on_clause_sql</span>(<span class="ruby-identifier">jc</span>)
373:       <span class="ruby-node">&quot;#{join_clause_sql(jc)} ON #{literal(filter_expr(jc.on))}&quot;</span>
374:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000712" class="method-detail">
        <a name="M000712"></a>

        <div class="method-heading">
          <a href="#M000712" class="method-signature">
          <span class="method-name">join_table</span><span class="method-args">(type, table, expr=nil, options={}) {|table_name, last_alias, @opts[:join] || []| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a joined dataset. Uses the following arguments:
</p>
<ul>
<li>type - The type of join to do (e.g. :inner)

</li>
<li>table - Depends on type:

<ul>
<li><a href="Dataset.html">Dataset</a> - a subselect is performed with an alias
of tN for some value of N

</li>
<li><a href="Model.html">Model</a> (<a href="Dataset.html#M000716">or</a>
anything responding to :table_name) - table.table_name

</li>
<li><a href="../String.html">String</a>, <a href="../Symbol.html">Symbol</a>:
table

</li>
</ul>
</li>
<li>expr - specifies conditions, depends on type:

<ul>
<li><a href="../Hash.html">Hash</a>, <a href="../Array.html">Array</a> with <a
href="Dataset.html#M000746">all</a> two pairs - Assumes key (1st arg) is
column of joined table (unless already qualified), <a
href="Dataset.html#M000683">and</a> value (2nd arg) is column of the <a
href="Dataset.html#M000665">last</a> joined <a
href="Dataset.html#M000716">or</a> primary table (<a
href="Dataset.html#M000716">or</a> the :implicit_qualifier option). To
specify multiple conditions on a single joined table column, you must use
an array. Uses a JOIN with an ON clause.

</li>
<li><a href="../Array.html">Array</a> - If <a
href="Dataset.html#M000746">all</a> members of the array are symbols,
considers them <a href="Dataset.html#M000745">as</a> <a
href="Dataset.html#M000748">columns</a> <a
href="Dataset.html#M000683">and</a> uses a JOIN with a USING clause. Most
databases will remove duplicate <a href="Dataset.html#M000748">columns</a>
<a href="Dataset.html#M000698">from</a> the result <a
href="Dataset.html#M000759">set</a> if this is used.

</li>
<li>nil - If a block is not given, doesn&#8216;t use ON <a
href="Dataset.html#M000716">or</a> USING, so the JOIN should be a NATURAL
<a href="Dataset.html#M000716">or</a> CROSS join. If a block is given, uses
a ON clause based on the block, see below.

</li>
<li>Everything else - pretty much the same <a
href="Dataset.html#M000745">as</a> a using the argument in a <a
href="Dataset.html#M000680">call</a> to <a
href="Dataset.html#M000696">filter</a>, so strings are considered <a
href="Dataset.html#M000714">literal</a>, symbols specify boolean <a
href="Dataset.html#M000748">columns</a>, <a
href="Dataset.html#M000683">and</a> blockless <a
href="Dataset.html#M000696">filter</a> expressions can be used. Uses a JOIN
with an ON clause.

</li>
</ul>
</li>
<li>options - a hash of options, with any of the following keys:

<ul>
<li>:table_alias - the name of the table&#8216;s alias when joining, necessary
for joining to the same table more than once. No alias is used by default.

</li>
<li>:implicit_qualifer - The name to use for qualifying implicit conditions. By
default, the <a href="Dataset.html#M000665">last</a> joined <a
href="Dataset.html#M000716">or</a> primary table is used.

</li>
</ul>
</li>
<li>block - The block argument should only be given if a JOIN with an ON clause
is used, in which case it yields the table alias/name for the table
currently being joined, the table alias/name for the <a
href="Dataset.html#M000665">last</a> joined (<a
href="Dataset.html#M000716">or</a> <a href="Dataset.html#M000660">first</a>
table), <a href="Dataset.html#M000683">and</a> an array of previous <a
href="SQL/JoinClause.html">SQL::JoinClause</a>.

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000712-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000712-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 411</span>
411:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">join_table</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">expr</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">options</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
412:       <span class="ruby-keyword kw">if</span> [<span class="ruby-constant">Symbol</span>, <span class="ruby-constant">String</span>].<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-identifier">c</span>)}
413:         <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">options</span>
414:         <span class="ruby-identifier">last_alias</span> = <span class="ruby-keyword kw">nil</span> 
415:       <span class="ruby-keyword kw">else</span>
416:         <span class="ruby-identifier">table_alias</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:table_alias</span>]
417:         <span class="ruby-identifier">last_alias</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:implicit_qualifier</span>]
418:       <span class="ruby-keyword kw">end</span>
419:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Dataset</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">table</span>
420:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">table_alias</span>.<span class="ruby-identifier">nil?</span>
421:           <span class="ruby-identifier">table_alias_num</span> = (<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:num_dataset_sources</span>] <span class="ruby-operator">||</span> <span class="ruby-value">0</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
422:           <span class="ruby-identifier">table_alias</span> = <span class="ruby-node">&quot;t#{table_alias_num}&quot;</span>
423:         <span class="ruby-keyword kw">end</span>
424:         <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">table_alias</span>
425:       <span class="ruby-keyword kw">else</span>
426:         <span class="ruby-identifier">table</span> = <span class="ruby-identifier">table</span>.<span class="ruby-identifier">table_name</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">table</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:table_name</span>)
427:         <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">table_alias</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">table</span>
428:       <span class="ruby-keyword kw">end</span>
429: 
430:       <span class="ruby-identifier">join</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">block_given?</span>
431:         <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">JoinClause</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">table_alias</span>)
432:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">Array</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">expr</span> <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">expr</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-constant">Symbol</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">x</span>}
433:         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;can't use a block if providing an array of symbols as expr&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
434:         <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">JoinUsingClause</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">expr</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">table_alias</span>)
435:       <span class="ruby-keyword kw">else</span>
436:         <span class="ruby-identifier">last_alias</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:last_joined_table</span>] <span class="ruby-operator">||</span> (<span class="ruby-identifier">first_source</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Dataset</span>) <span class="ruby-operator">?</span> <span class="ruby-value str">'t1'</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">first_source</span>)
437:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">condition_specifier?</span>(<span class="ruby-identifier">expr</span>)
438:           <span class="ruby-identifier">expr</span> = <span class="ruby-identifier">expr</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
439:             <span class="ruby-identifier">k</span> = <span class="ruby-identifier">qualified_column_name</span>(<span class="ruby-identifier">k</span>, <span class="ruby-identifier">table_name</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)
440:             <span class="ruby-identifier">v</span> = <span class="ruby-identifier">qualified_column_name</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">last_alias</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)
441:             [<span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span>]
442:           <span class="ruby-keyword kw">end</span>
443:         <span class="ruby-keyword kw">end</span>
444:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
445:           <span class="ruby-identifier">expr2</span> = <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">last_alias</span>, <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:join</span>] <span class="ruby-operator">||</span> [])
446:           <span class="ruby-identifier">expr</span> = <span class="ruby-identifier">expr</span> <span class="ruby-value">? </span><span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:AND</span>, <span class="ruby-identifier">expr</span>, <span class="ruby-identifier">expr2</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">expr2</span>
447:         <span class="ruby-keyword kw">end</span>
448:         <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">JoinOnClause</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">expr</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">table_alias</span>)
449:       <span class="ruby-keyword kw">end</span>
450: 
451:       <span class="ruby-identifier">opts</span> = {<span class="ruby-identifier">:join</span> =<span class="ruby-operator">&gt;</span> (<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:join</span>] <span class="ruby-operator">||</span> []) <span class="ruby-operator">+</span> [<span class="ruby-identifier">join</span>], <span class="ruby-identifier">:last_joined_table</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">table_name</span>}
452:       <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:num_dataset_sources</span>] = <span class="ruby-identifier">table_alias_num</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">table_alias_num</span>
453:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">opts</span>)
454:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000711" class="method-detail">
        <a name="M000711"></a>

        <div class="method-heading">
          <a href="#M000711" class="method-signature">
          <span class="method-name">join_using_clause_sql</span><span class="method-args">(jc)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment specifying a JOIN clause with USING.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000711-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000711-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 377</span>
377:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">join_using_clause_sql</span>(<span class="ruby-identifier">jc</span>)
378:       <span class="ruby-node">&quot;#{join_clause_sql(jc)} USING (#{column_list(jc.using)})&quot;</span>
379:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000665" class="method-detail">
        <a name="M000665"></a>

        <div class="method-heading">
          <a href="#M000665" class="method-signature">
          <span class="method-name">last</span><span class="method-args">(*args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Reverses the <a href="Dataset.html#M000717">order</a> <a
href="Dataset.html#M000683">and</a> then runs <a
href="Dataset.html#M000660">first</a>. Note that this will not necessarily
give you the <a href="Dataset.html#M000665">last</a> record in the dataset,
unless you have an unambiguous <a href="Dataset.html#M000717">order</a>. If
there is not currently an <a href="Dataset.html#M000717">order</a> for this
dataset, raises an <a href="Error.html">Error</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000665-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000665-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 140</span>
140:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">last</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
141:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">'No order specified'</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:order</span>]
142:       <span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">first</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
143:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000713" class="method-detail">
        <a name="M000713"></a>

        <div class="method-heading">
          <a href="#M000713" class="method-signature">
          <span class="method-name">limit</span><span class="method-args">(l, o = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
If given an integer, the dataset will contain only the <a
href="Dataset.html#M000660">first</a> l results. If given a <a
href="Dataset.html#M000670">range</a>, it will contain only those at
offsets within that <a href="Dataset.html#M000670">range</a>. If a second
argument is given, it is used <a href="Dataset.html#M000745">as</a> an
offset.
</p>
<pre>
  dataset.limit(10) # SQL: SELECT * FROM items LIMIT 10
  dataset.limit(10, 20) # SQL: SELECT * FROM items LIMIT 10 OFFSET 20
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000713-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000713-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 462</span>
462:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">limit</span>(<span class="ruby-identifier">l</span>, <span class="ruby-identifier">o</span> = <span class="ruby-keyword kw">nil</span>)
463:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">from_self</span>.<span class="ruby-identifier">limit</span>(<span class="ruby-identifier">l</span>, <span class="ruby-identifier">o</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:sql</span>]
464: 
465:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Range</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">l</span>
466:         <span class="ruby-identifier">o</span> = <span class="ruby-identifier">l</span>.<span class="ruby-identifier">first</span>
467:         <span class="ruby-identifier">l</span> = <span class="ruby-identifier">l</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">l</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">l</span>.<span class="ruby-identifier">exclude_end?</span> <span class="ruby-value">? </span><span class="ruby-value">0</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>)
468:       <span class="ruby-keyword kw">end</span>
469:       <span class="ruby-identifier">l</span> = <span class="ruby-identifier">l</span>.<span class="ruby-identifier">to_i</span>
470:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">'Limits must be greater than or equal to 1'</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">l</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">1</span>
471:       <span class="ruby-identifier">opts</span> = {<span class="ruby-identifier">:limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">l</span>}
472:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">o</span>
473:         <span class="ruby-identifier">o</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">to_i</span>
474:         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">'Offsets must be greater than or equal to 0'</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">o</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>
475:         <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:offset</span>] = <span class="ruby-identifier">o</span>
476:       <span class="ruby-keyword kw">end</span>
477:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">opts</span>)
478:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000714" class="method-detail">
        <a name="M000714"></a>

        <div class="method-heading">
          <a href="#M000714" class="method-signature">
          <span class="method-name">literal</span><span class="method-args">(v)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a <a href="Dataset.html#M000714">literal</a> representation of a
value to be used <a href="Dataset.html#M000745">as</a> part of an <a
href="SQL.html">SQL</a> expression.
</p>
<pre>
  dataset.literal(&quot;abc'def\\&quot;) #=&gt; &quot;'abc''def\\\\'&quot;
  dataset.literal(:items__id) #=&gt; &quot;items.id&quot;
  dataset.literal([1, 2, 3]) =&gt; &quot;(1, 2, 3)&quot;
  dataset.literal(DB[:items]) =&gt; &quot;(SELECT * FROM items)&quot;
  dataset.literal(:x + 1 &gt; :y) =&gt; &quot;((x + 1) &gt; y)&quot;
</pre>
<p>
If an unsupported object is given, an exception is raised.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000714-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000714-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 490</span>
490:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">v</span>)
491:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">v</span>
492:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
493:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">v</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">LiteralString</span>)
494:         <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Blob</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">literal_blob</span>(<span class="ruby-identifier">v</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">literal_string</span>(<span class="ruby-identifier">v</span>)
495:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
496:         <span class="ruby-identifier">literal_symbol</span>(<span class="ruby-identifier">v</span>)
497:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Integer</span>
498:         <span class="ruby-identifier">literal_integer</span>(<span class="ruby-identifier">v</span>)
499:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>
500:         <span class="ruby-identifier">literal_hash</span>(<span class="ruby-identifier">v</span>)
501:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Expression</span>
502:         <span class="ruby-identifier">literal_expression</span>(<span class="ruby-identifier">v</span>)
503:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Float</span>
504:         <span class="ruby-identifier">literal_float</span>(<span class="ruby-identifier">v</span>)
505:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">BigDecimal</span>
506:         <span class="ruby-identifier">literal_big_decimal</span>(<span class="ruby-identifier">v</span>)
507:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">NilClass</span>
508:         <span class="ruby-constant">NULL</span>
509:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">TrueClass</span>
510:         <span class="ruby-identifier">literal_true</span>
511:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">FalseClass</span>
512:         <span class="ruby-identifier">literal_false</span>
513:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
514:         <span class="ruby-identifier">literal_array</span>(<span class="ruby-identifier">v</span>)
515:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Time</span>
516:         <span class="ruby-identifier">literal_time</span>(<span class="ruby-identifier">v</span>)
517:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">DateTime</span>
518:         <span class="ruby-identifier">literal_datetime</span>(<span class="ruby-identifier">v</span>)
519:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Date</span>
520:         <span class="ruby-identifier">literal_date</span>(<span class="ruby-identifier">v</span>)
521:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Dataset</span>
522:         <span class="ruby-identifier">literal_dataset</span>(<span class="ruby-identifier">v</span>)
523:       <span class="ruby-keyword kw">else</span>
524:         <span class="ruby-identifier">literal_other</span>(<span class="ruby-identifier">v</span>)
525:       <span class="ruby-keyword kw">end</span>
526:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000666" class="method-detail">
        <a name="M000666"></a>

        <div class="method-heading">
          <a href="#M000666" class="method-signature">
          <span class="method-name">map</span><span class="method-args">(column=nil, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Maps column values for <a href="Dataset.html#M000752">each</a> record in
the dataset (if a column name is given), <a
href="Dataset.html#M000716">or</a> performs the stock mapping functionality
of Enumerable. Raises an error if both an argument <a
href="Dataset.html#M000683">and</a> block are given. Examples:
</p>
<pre>
  ds.map(:id) =&gt; [1, 2, 3, ...]
  ds.map{|r| r[:id] * 2} =&gt; [2, 4, 6, ...]
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000666-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000666-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 151</span>
151:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">map</span>(<span class="ruby-identifier">column</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
152:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">column</span>
153:         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-constant">MAP_ERROR_MSG</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
154:         <span class="ruby-keyword kw">super</span>(){<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>[<span class="ruby-identifier">column</span>]}
155:       <span class="ruby-keyword kw">else</span>
156:         <span class="ruby-keyword kw">super</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
157:       <span class="ruby-keyword kw">end</span>
158:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000667" class="method-detail">
        <a name="M000667"></a>

        <div class="method-heading">
          <a href="#M000667" class="method-signature">
          <span class="method-name">max</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the maximum value for the given column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000667-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000667-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 161</span>
161:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">max</span>(<span class="ruby-identifier">column</span>)
162:       <span class="ruby-identifier">get</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">max</span>(<span class="ruby-identifier">column</span>)}
163:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000668" class="method-detail">
        <a name="M000668"></a>

        <div class="method-heading">
          <a href="#M000668" class="method-signature">
          <span class="method-name">min</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the minimum value for the given column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000668-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000668-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 166</span>
166:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">min</span>(<span class="ruby-identifier">column</span>)
167:       <span class="ruby-identifier">get</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">min</span>(<span class="ruby-identifier">column</span>)}
168:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000669" class="method-detail">
        <a name="M000669"></a>

        <div class="method-heading">
          <a href="#M000669" class="method-signature">
          <span class="method-name">multi_insert</span><span class="method-args">(hashes, opts={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This is a front end for <a href="Dataset.html#M000663">import</a> that
allows you to submit an array of hashes instead of arrays of <a
href="Dataset.html#M000748">columns</a> <a
href="Dataset.html#M000683">and</a> values:
</p>
<pre>
  dataset.multi_insert([{:x =&gt; 1}, {:x =&gt; 2}])
</pre>
<p>
Be aware that <a href="Dataset.html#M000746">all</a> hashes should have the
same keys if you use this calling method, otherwise some <a
href="Dataset.html#M000748">columns</a> could be missed <a
href="Dataset.html#M000716">or</a> <a href="Dataset.html#M000759">set</a>
to null instead of to default values.
</p>
<p>
You can also use the :slice <a href="Dataset.html#M000716">or</a>
:commit_every option that <a href="Dataset.html#M000663">import</a>
accepts.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000669-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000669-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 180</span>
180:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">multi_insert</span>(<span class="ruby-identifier">hashes</span>, <span class="ruby-identifier">opts</span>={})
181:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hashes</span>.<span class="ruby-identifier">empty?</span>
182:       <span class="ruby-identifier">columns</span> = <span class="ruby-identifier">hashes</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">keys</span>
183:       <span class="ruby-identifier">import</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">hashes</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">c</span>]}}, <span class="ruby-identifier">opts</span>)
184:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000715" class="method-detail">
        <a name="M000715"></a>

        <div class="method-heading">
          <a href="#M000715" class="method-signature">
          <span class="method-name">multi_insert_sql</span><span class="method-args">(columns, values)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array of <a href="Dataset.html#M000754">insert</a> statements
for inserting multiple records. This method is used by <a
href="Dataset.html#M000669">multi_insert</a> to format <a
href="Dataset.html#M000754">insert</a> statements <a
href="Dataset.html#M000683">and</a> expects a keys array <a
href="Dataset.html#M000683">and</a> <a href="Dataset.html#M000683">and</a>
an array of value arrays.
</p>
<p>
This method should be overridden by descendants if the support inserting
multiple records in a single <a href="SQL.html">SQL</a> statement.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000715-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000715-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 534</span>
534:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">multi_insert_sql</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">values</span>)
535:       <span class="ruby-identifier">s</span> = <span class="ruby-node">&quot;INSERT INTO #{source_list(@opts[:from])} (#{identifier_list(columns)}) VALUES &quot;</span>
536:       <span class="ruby-identifier">values</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">s</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">r</span>)}
537:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000756" class="method-detail">
        <a name="M000756"></a>

        <div class="method-heading">
          <a href="#M000756" class="method-signature">
          <span class="method-name">naked</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a <a href="Dataset.html#M000756">naked</a> dataset <a
href="Dataset.html#M000747">clone</a> - i.e. a dataset that returns records
<a href="Dataset.html#M000745">as</a> hashes instead of calling the row
proc.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000756-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000756-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 210</span>
210:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">naked</span>
211:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">clone</span>
212:       <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">row_proc</span> = <span class="ruby-keyword kw">nil</span>
213:       <span class="ruby-identifier">ds</span>
214:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000716" class="method-detail">
        <a name="M000716"></a>

        <div class="method-heading">
          <a href="#M000716" class="method-signature">
          <span class="method-name">or</span><span class="method-args">(*cond, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds an alternate <a href="Dataset.html#M000696">filter</a> to an existing
<a href="Dataset.html#M000696">filter</a> using OR. If no <a
href="Dataset.html#M000696">filter</a> <a
href="Dataset.html#M000695">exists</a> an error is raised.
</p>
<pre>
  dataset.filter(:a).or(:b) # SQL: SELECT * FROM items WHERE a OR b
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000716-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000716-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 543</span>
543:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">or</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
544:       <span class="ruby-identifier">clause</span> = (<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:having</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">:having</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">:where</span>)
545:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">InvalidOperation</span>, <span class="ruby-value str">&quot;No existing filter found.&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">clause</span>]
546:       <span class="ruby-identifier">cond</span> = <span class="ruby-identifier">cond</span>.<span class="ruby-identifier">first</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cond</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
547:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">clause</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">BooleanExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:OR</span>, <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">clause</span>], <span class="ruby-identifier">filter_expr</span>(<span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)))
548:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000717" class="method-detail">
        <a name="M000717"></a>

        <div class="method-heading">
          <a href="#M000717" class="method-signature">
          <span class="method-name">order</span><span class="method-args">(*columns, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the <a
href="Dataset.html#M000717">order</a> changed. If a nil is given the
returned dataset has no <a href="Dataset.html#M000717">order</a>. This can
accept multiple arguments of varying kinds, <a
href="Dataset.html#M000683">and</a> even <a href="SQL.html">SQL</a>
functions. If a block is given, it is treated <a
href="Dataset.html#M000745">as</a> a virtual row block, similar to <a
href="Dataset.html#M000696">filter</a>.
</p>
<pre>
  ds.order(:name).sql #=&gt; 'SELECT * FROM items ORDER BY name'
  ds.order(:a, :b).sql #=&gt; 'SELECT * FROM items ORDER BY a, b'
  ds.order('a + b'.lit).sql #=&gt; 'SELECT * FROM items ORDER BY a + b'
  ds.order(:a + :b).sql #=&gt; 'SELECT * FROM items ORDER BY (a + b)'
  ds.order(:name.desc).sql #=&gt; 'SELECT * FROM items ORDER BY name DESC'
  ds.order(:name.asc).sql #=&gt; 'SELECT * FROM items ORDER BY name ASC'
  ds.order{|o| o.sum(:name)}.sql #=&gt; 'SELECT * FROM items ORDER BY sum(name)'
  ds.order(nil).sql #=&gt; 'SELECT * FROM items'
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000717-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000717-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 563</span>
563:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
564:       <span class="ruby-identifier">columns</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">virtual_row_block_call</span>(<span class="ruby-identifier">block</span>)) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
565:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> (<span class="ruby-identifier">columns</span>.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">empty?</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">columns</span>)
566:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000718" class="method-detail">
        <a name="M000718"></a>

        <div class="method-heading">
          <span class="method-name">order_by</span><span class="method-args">(*columns, &amp;block)</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000717">order</a>
</p>
        </div>
      </div>

      <div id="method-M000719" class="method-detail">
        <a name="M000719"></a>

        <div class="method-heading">
          <a href="#M000719" class="method-signature">
          <span class="method-name">order_more</span><span class="method-args">(*columns, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the <a
href="Dataset.html#M000717">order</a> <a
href="Dataset.html#M000748">columns</a> added to the existing <a
href="Dataset.html#M000717">order</a>.
</p>
<pre>
  ds.order(:a).order(:b).sql #=&gt; 'SELECT * FROM items ORDER BY b'
  ds.order(:a).order_more(:b).sql #=&gt; 'SELECT * FROM items ORDER BY a, b'
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000719-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000719-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 574</span>
574:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">order_more</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
575:       <span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-constant">Array</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:order</span>]).<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">columns</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
576:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000720" class="method-detail">
        <a name="M000720"></a>

        <div class="method-heading">
          <a href="#M000720" class="method-signature">
          <span class="method-name">ordered_expression_sql</span><span class="method-args">(oe)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for the ordered expression, used in the
ORDER BY clause.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000720-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000720-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 580</span>
580:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ordered_expression_sql</span>(<span class="ruby-identifier">oe</span>)
581:       <span class="ruby-node">&quot;#{literal(oe.expression)} #{oe.descending ? 'DESC' : 'ASC'}&quot;</span>
582:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000764" class="method-detail">
        <a name="M000764"></a>

        <div class="method-heading">
          <a href="#M000764" class="method-signature">
          <span class="method-name">paginate</span><span class="method-args">(page_no, page_size, record_count=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a paginated dataset. The returned dataset is limited to the page
size at the correct offset, <a href="Dataset.html#M000683">and</a> extended
with the <a href="Dataset/Pagination.html">Pagination</a> module. If a
record <a href="Dataset.html#M000690">count</a> is not provided, does a <a
href="Dataset.html#M000690">count</a> of total number of records for this
dataset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000764-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000764-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/extensions/pagination.rb, line 7</span>
 7:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">paginate</span>(<span class="ruby-identifier">page_no</span>, <span class="ruby-identifier">page_size</span>, <span class="ruby-identifier">record_count</span>=<span class="ruby-keyword kw">nil</span>)
 8:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;You cannot paginate a dataset that already has a limit&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:limit</span>]
 9:       <span class="ruby-identifier">paginated</span> = <span class="ruby-identifier">limit</span>(<span class="ruby-identifier">page_size</span>, (<span class="ruby-identifier">page_no</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">page_size</span>)
10:       <span class="ruby-identifier">paginated</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">Pagination</span>)
11:       <span class="ruby-identifier">paginated</span>.<span class="ruby-identifier">set_pagination_info</span>(<span class="ruby-identifier">page_no</span>, <span class="ruby-identifier">page_size</span>, <span class="ruby-identifier">record_count</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">count</span>)
12:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000721" class="method-detail">
        <a name="M000721"></a>

        <div class="method-heading">
          <a href="#M000721" class="method-signature">
          <span class="method-name">placeholder_literal_string_sql</span><span class="method-args">(pls)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for a <a
href="Dataset.html#M000714">literal</a> string with placeholders
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000721-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000721-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 585</span>
585:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">placeholder_literal_string_sql</span>(<span class="ruby-identifier">pls</span>)
586:       <span class="ruby-identifier">args</span> = <span class="ruby-identifier">pls</span>.<span class="ruby-identifier">args</span>.<span class="ruby-identifier">dup</span>
587:       <span class="ruby-identifier">s</span> = <span class="ruby-identifier">pls</span>.<span class="ruby-identifier">str</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-constant">QUESTION_MARK</span>){<span class="ruby-identifier">literal</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>)}
588:       <span class="ruby-identifier">s</span> = <span class="ruby-node">&quot;(#{s})&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pls</span>.<span class="ruby-identifier">parens</span>
589:       <span class="ruby-identifier">s</span>
590:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000655" class="method-detail">
        <a name="M000655"></a>

        <div class="method-heading">
          <a href="#M000655" class="method-signature">
          <span class="method-name">prepare</span><span class="method-args">(type, name=nil, values=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Create a named prepared statement that is stored in the database (<a
href="Dataset.html#M000683">and</a> connection) for reuse.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000655-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000655-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/adapters/jdbc.rb, line 437</span>
437:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prepare</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">name</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">values</span>=<span class="ruby-keyword kw">nil</span>)
438:         <span class="ruby-identifier">ps</span> = <span class="ruby-identifier">to_prepared_statement</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">values</span>)
439:         <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">PreparedStatementMethods</span>)
440:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>
441:           <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">prepared_statement_name</span> = <span class="ruby-identifier">name</span>
442:           <span class="ruby-identifier">db</span>.<span class="ruby-identifier">prepared_statements</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">ps</span>
443:         <span class="ruby-keyword kw">end</span>
444:         <span class="ruby-identifier">ps</span>
445:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000681" class="method-detail">
        <a name="M000681"></a>

        <div class="method-heading">
          <a href="#M000681" class="method-signature">
          <span class="method-name">prepare</span><span class="method-args">(type, name=nil, values=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Prepare an <a href="SQL.html">SQL</a> statement for later execution. This
returns a <a href="Dataset.html#M000747">clone</a> of the dataset extended
with <a
href="Dataset/PreparedStatementMethods.html">PreparedStatementMethods</a>,
on which you can <a href="Dataset.html#M000680">call</a> <a
href="Dataset.html#M000680">call</a> with the hash of bind variables to do
substitution. The prepared statement is also stored in the associated
database. The following usage is identical:
</p>
<pre>
  ps = prepare(:select, :select_by_name)
  ps.call(:name=&gt;'Blah')
  db.call(:select_by_name, :name=&gt;'Blah')
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000681-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000681-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/prepared_statements.rb, line 194</span>
194:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prepare</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">name</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">values</span>=<span class="ruby-keyword kw">nil</span>)
195:       <span class="ruby-identifier">ps</span> = <span class="ruby-identifier">to_prepared_statement</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">values</span>)
196:       <span class="ruby-identifier">db</span>.<span class="ruby-identifier">prepared_statements</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">ps</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>
197:       <span class="ruby-identifier">ps</span>
198:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000766" class="method-detail">
        <a name="M000766"></a>

        <div class="method-heading">
          <a href="#M000766" class="method-signature">
          <span class="method-name">print</span><span class="method-args">(*cols)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Pretty prints the records in the dataset <a
href="Dataset.html#M000745">as</a> plain-text table.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000766-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000766-source">
<pre>
   <span class="ruby-comment cmt"># File lib/sequel/extensions/pretty_table.rb, line 4</span>
4:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">print</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cols</span>)
5:       <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">PrettyTable</span>.<span class="ruby-identifier">print</span>(<span class="ruby-identifier">naked</span>.<span class="ruby-identifier">all</span>, <span class="ruby-identifier">cols</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-identifier">columns</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">cols</span>)
6:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000722" class="method-detail">
        <a name="M000722"></a>

        <div class="method-heading">
          <a href="#M000722" class="method-signature">
          <span class="method-name">qualified_identifier_sql</span><span class="method-args">(qcr)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for the qualifed identifier, specifying
a table <a href="Dataset.html#M000683">and</a> a column (<a
href="Dataset.html#M000716">or</a> schema <a
href="Dataset.html#M000683">and</a> table).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000722-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000722-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 594</span>
594:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">qualified_identifier_sql</span>(<span class="ruby-identifier">qcr</span>)
595:       [<span class="ruby-identifier">qcr</span>.<span class="ruby-identifier">table</span>, <span class="ruby-identifier">qcr</span>.<span class="ruby-identifier">column</span>].<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> [<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>, <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Identifier</span>, <span class="ruby-constant">Symbol</span>].<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-identifier">c</span>)} <span class="ruby-operator">?</span> <span class="ruby-identifier">literal</span>(<span class="ruby-identifier">x</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">quote_identifier</span>(<span class="ruby-identifier">x</span>)}.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'.'</span>)
596:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000767" class="method-detail">
        <a name="M000767"></a>

        <div class="method-heading">
          <a href="#M000767" class="method-signature">
          <span class="method-name">query</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Translates a <a href="Dataset.html#M000767">query</a> block into a dataset.
Query blocks can be useful when expressing complex SELECT statements, e.g.:
</p>
<pre>
  dataset = DB[:items].query do
    select :x, :y, :z
    filter{|o| (o.x &gt; 1) &amp; (o.y &gt; 2)}
    order :z.desc
  end
</pre>
<p>
Which is the same <a href="Dataset.html#M000745">as</a>:
</p>
<pre>
 dataset = DB[:items].select(:x, :y, :z).filter{|o| (o.x &gt; 1) &amp; (o.y &gt; 2)}.order(:z.desc)
</pre>
<p>
Note that inside a <a href="Dataset.html#M000680">call</a> to <a
href="Dataset.html#M000767">query</a>, you cannot <a
href="Dataset.html#M000680">call</a> <a
href="Dataset.html#M000752">each</a>, <a
href="Dataset.html#M000754">insert</a>, <a
href="Dataset.html#M000762">update</a>, <a
href="Dataset.html#M000716">or</a> <a
href="Dataset.html#M000751">delete</a> (<a
href="Dataset.html#M000716">or</a> any method that calls those), <a
href="Dataset.html#M000716">or</a> <a href="../Sequel.html">Sequel</a> will
raise an error.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000767-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000767-source">
<pre>
    <span class="ruby-comment cmt"># File lib/sequel/extensions/query.rb, line 26</span>
26:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">query</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
27:       <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">clone</span>({})
28:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">QueryBlockCopy</span>)
29:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
30:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">copy</span>.<span class="ruby-identifier">opts</span>)
31:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000723" class="method-detail">
        <a name="M000723"></a>

        <div class="method-heading">
          <a href="#M000723" class="method-signature">
          <span class="method-name">quote_identifier</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds quoting to identifiers (<a href="Dataset.html#M000748">columns</a> <a
href="Dataset.html#M000683">and</a> tables). If identifiers are not being
quoted, returns name <a href="Dataset.html#M000745">as</a> a string. If
identifiers are being quoted quote the name with <a
href="Dataset.html#M000725">quoted_identifier</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000723-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000723-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 601</span>
601:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">quote_identifier</span>(<span class="ruby-identifier">name</span>)
602:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">name</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">LiteralString</span>)
603:       <span class="ruby-identifier">name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">value</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Identifier</span>)
604:       <span class="ruby-identifier">name</span> = <span class="ruby-identifier">input_identifier</span>(<span class="ruby-identifier">name</span>)
605:       <span class="ruby-identifier">name</span> = <span class="ruby-identifier">quoted_identifier</span>(<span class="ruby-identifier">name</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">quote_identifiers?</span>
606:       <span class="ruby-identifier">name</span>
607:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000757" class="method-detail">
        <a name="M000757"></a>

        <div class="method-heading">
          <a href="#M000757" class="method-signature">
          <span class="method-name">quote_identifiers?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Whether this dataset quotes identifiers.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000757-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000757-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 217</span>
217:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">quote_identifiers?</span>
218:       <span class="ruby-ivar">@quote_identifiers</span>
219:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000724" class="method-detail">
        <a name="M000724"></a>

        <div class="method-heading">
          <a href="#M000724" class="method-signature">
          <span class="method-name">quote_schema_table</span><span class="method-args">(table)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Separates the schema <a href="Dataset.html#M000698">from</a> the table <a
href="Dataset.html#M000683">and</a> returns a string with them quoted (if
quoting identifiers)
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000724-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000724-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 611</span>
611:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">quote_schema_table</span>(<span class="ruby-identifier">table</span>)
612:       <span class="ruby-identifier">schema</span>, <span class="ruby-identifier">table</span> = <span class="ruby-identifier">schema_and_table</span>(<span class="ruby-identifier">table</span>)
613:       <span class="ruby-node">&quot;#{&quot;#{quote_identifier(schema)}.&quot; if schema}#{quote_identifier(table)}&quot;</span>
614:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000725" class="method-detail">
        <a name="M000725"></a>

        <div class="method-heading">
          <a href="#M000725" class="method-signature">
          <span class="method-name">quoted_identifier</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method quotes the given name with the <a href="SQL.html">SQL</a>
standard double quote. should be overridden by subclasses to provide
quoting not matching the <a href="SQL.html">SQL</a> standard, such <a
href="Dataset.html#M000745">as</a> backtick (used by <a
href="MySQL.html">MySQL</a> <a href="Dataset.html#M000683">and</a> <a
href="SQLite.html">SQLite</a>).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000725-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000725-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 619</span>
619:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">quoted_identifier</span>(<span class="ruby-identifier">name</span>)
620:       <span class="ruby-node">&quot;\&quot;#{name.to_s.gsub('&quot;', '&quot;&quot;')}\&quot;&quot;</span>
621:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000670" class="method-detail">
        <a name="M000670"></a>

        <div class="method-heading">
          <a href="#M000670" class="method-signature">
          <span class="method-name">range</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a Range object made <a href="Dataset.html#M000698">from</a> the
minimum <a href="Dataset.html#M000683">and</a> maximum values for the given
column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000670-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000670-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 188</span>
188:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">range</span>(<span class="ruby-identifier">column</span>)
189:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">r</span> = <span class="ruby-identifier">select</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">o</span>.<span class="ruby-identifier">min</span>(<span class="ruby-identifier">column</span>).<span class="ruby-identifier">as</span>(<span class="ruby-identifier">:v1</span>), <span class="ruby-identifier">o</span>.<span class="ruby-identifier">max</span>(<span class="ruby-identifier">column</span>).<span class="ruby-identifier">as</span>(<span class="ruby-identifier">:v2</span>)]}.<span class="ruby-identifier">first</span>
190:         (<span class="ruby-identifier">r</span>[<span class="ruby-identifier">:v1</span>]<span class="ruby-operator">..</span><span class="ruby-identifier">r</span>[<span class="ruby-identifier">:v2</span>])
191:       <span class="ruby-keyword kw">end</span>
192:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000727" class="method-detail">
        <a name="M000727"></a>

        <div class="method-heading">
          <span class="method-name">reverse</span><span class="method-args">(*order)</span>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000726">reverse_order</a>
</p>
        </div>
      </div>

      <div id="method-M000726" class="method-detail">
        <a name="M000726"></a>

        <div class="method-heading">
          <a href="#M000726" class="method-signature">
          <span class="method-name">reverse_order</span><span class="method-args">(*order)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the <a
href="Dataset.html#M000717">order</a> reversed. If no <a
href="Dataset.html#M000717">order</a> is given, the existing <a
href="Dataset.html#M000717">order</a> is inverted.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000726-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000726-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 625</span>
625:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reverse_order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">order</span>)
626:       <span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">invert_order</span>(<span class="ruby-identifier">order</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:order</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">order</span>))
627:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000728" class="method-detail">
        <a name="M000728"></a>

        <div class="method-heading">
          <a href="#M000728" class="method-signature">
          <span class="method-name">schema_and_table</span><span class="method-args">(table_name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Split the schema information <a href="Dataset.html#M000698">from</a> the
table
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000728-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000728-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 631</span>
631:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">schema_and_table</span>(<span class="ruby-identifier">table_name</span>)
632:       <span class="ruby-identifier">sch</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">default_schema</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">db</span>
633:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">table_name</span>
634:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Symbol</span>
635:         <span class="ruby-identifier">s</span>, <span class="ruby-identifier">t</span>, <span class="ruby-identifier">a</span> = <span class="ruby-identifier">split_symbol</span>(<span class="ruby-identifier">table_name</span>)
636:         [<span class="ruby-identifier">s</span><span class="ruby-operator">||</span><span class="ruby-identifier">sch</span>, <span class="ruby-identifier">t</span>]
637:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">QualifiedIdentifier</span>
638:         [<span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">table</span>, <span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">column</span>]
639:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">Identifier</span>
640:         [<span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">value</span>]
641:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
642:         [<span class="ruby-identifier">sch</span>, <span class="ruby-identifier">table_name</span>]
643:       <span class="ruby-keyword kw">else</span>
644:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-value str">'table_name should be a Symbol, SQL::QualifiedIdentifier, SQL::Identifier, or String'</span>
645:       <span class="ruby-keyword kw">end</span>
646:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000729" class="method-detail">
        <a name="M000729"></a>

        <div class="method-heading">
          <a href="#M000729" class="method-signature">
          <span class="method-name">select</span><span class="method-args">(*columns, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the <a
href="Dataset.html#M000748">columns</a> selected changed to the given <a
href="Dataset.html#M000748">columns</a>. This also takes a virtual row
block, similar to <a href="Dataset.html#M000696">filter</a>.
</p>
<pre>
  dataset.select(:a) # SELECT a FROM items
  dataset.select(:a, :b) # SELECT a, b FROM items
  dataset.select{|o| o.a, o.sum(:b)} # SELECT a, sum(b) FROM items
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000729-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000729-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 655</span>
655:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
656:       <span class="ruby-identifier">columns</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">virtual_row_block_call</span>(<span class="ruby-identifier">block</span>)) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
657:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">columns</span>)
658:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000730" class="method-detail">
        <a name="M000730"></a>

        <div class="method-heading">
          <a href="#M000730" class="method-signature">
          <span class="method-name">select_all</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset selecting the wildcard.
</p>
<pre>
  dataset.select(:a).select_all # SELECT * FROM items
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000730-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000730-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 663</span>
663:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select_all</span>
664:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
665:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000731" class="method-detail">
        <a name="M000731"></a>

        <div class="method-heading">
          <a href="#M000731" class="method-signature">
          <span class="method-name">select_more</span><span class="method-args">(*columns, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the given <a
href="Dataset.html#M000748">columns</a> added to the existing selected <a
href="Dataset.html#M000748">columns</a>.
</p>
<pre>
  dataset.select(:a).select(:b) # SELECT b FROM items
  dataset.select(:a).select_more(:b) # SELECT a, b FROM items
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000731-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000731-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 672</span>
672:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select_more</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
673:       <span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-constant">Array</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:select</span>]).<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">columns</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
674:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000732" class="method-detail">
        <a name="M000732"></a>

        <div class="method-heading">
          <a href="#M000732" class="method-signature">
          <span class="method-name">select_sql</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Formats a SELECT statement
</p>
<pre>
  dataset.select_sql # =&gt; &quot;SELECT * FROM items&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000732-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000732-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 679</span>
679:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select_sql</span>
680:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">static_sql</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:sql</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:sql</span>]
681:       <span class="ruby-identifier">sql</span> = <span class="ruby-value str">'SELECT'</span>
682:       <span class="ruby-identifier">select_clause_order</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;select_#{x}_sql&quot;</span><span class="ruby-node">&quot;select_#{x}_sql&quot;</span>, <span class="ruby-identifier">sql</span>)}
683:       <span class="ruby-identifier">sql</span>
684:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000758" class="method-detail">
        <a name="M000758"></a>

        <div class="method-heading">
          <a href="#M000758" class="method-signature">
          <span class="method-name">server</span><span class="method-args">(servr)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set the <a href="Dataset.html#M000758">server</a> for this dataset to use.
Used to pick a specific database shard to run a <a
href="Dataset.html#M000767">query</a> against, <a
href="Dataset.html#M000716">or</a> to override the default (which is SELECT
uses :read_only database <a href="Dataset.html#M000683">and</a> <a
href="Dataset.html#M000746">all</a> other queries use the :default
database).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000758-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000758-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 224</span>
224:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">server</span>(<span class="ruby-identifier">servr</span>)
225:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:server=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">servr</span>)
226:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000759" class="method-detail">
        <a name="M000759"></a>

        <div class="method-heading">
          <a href="#M000759" class="method-signature">
          <span class="method-name">set</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Dataset.html#M000759">set</a>, but not aliased directly
so subclasses don&#8216;t have to override both methods.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000759-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000759-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 230</span>
230:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
231:       <span class="ruby-identifier">update</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
232:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000760" class="method-detail">
        <a name="M000760"></a>

        <div class="method-heading">
          <a href="#M000760" class="method-signature">
          <span class="method-name">set_defaults</span><span class="method-args">(hash)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set the default values for <a href="Dataset.html#M000754">insert</a> <a
href="Dataset.html#M000683">and</a> <a
href="Dataset.html#M000762">update</a> statements. The values passed to <a
href="Dataset.html#M000754">insert</a> <a
href="Dataset.html#M000716">or</a> <a
href="Dataset.html#M000762">update</a> are merged into this hash.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000760-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000760-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 236</span>
236:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_defaults</span>(<span class="ruby-identifier">hash</span>)
237:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:defaults=</span><span class="ruby-operator">&gt;</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:defaults</span>]<span class="ruby-operator">||</span>{}).<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">hash</span>))
238:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000678" class="method-detail">
        <a name="M000678"></a>

        <div class="method-heading">
          <a href="#M000678" class="method-signature">
          <span class="method-name">set_graph_aliases</span><span class="method-args">(graph_aliases)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This allows you to manually specify the <a
href="Dataset.html#M000677">graph</a> aliases to use when using <a
href="Dataset.html#M000677">graph</a>. You can use it to only <a
href="Dataset.html#M000729">select</a> certain <a
href="Dataset.html#M000748">columns</a>, <a
href="Dataset.html#M000683">and</a> have those <a
href="Dataset.html#M000748">columns</a> mapped to specific aliases in the
result <a href="Dataset.html#M000759">set</a>. This is the equivalent of
.<a href="Dataset.html#M000729">select</a> for a graphed dataset, <a
href="Dataset.html#M000683">and</a> must be used instead of .<a
href="Dataset.html#M000729">select</a> whenever graphing is used. Example:
</p>
<pre>
  DB[:artists].graph(:albums, :artist_id=&gt;:id).set_graph_aliases(:artist_name=&gt;[:artists, :name], :album_name=&gt;[:albums, :name], :forty_two=&gt;[:albums, :fourtwo, 42]).first
  =&gt; {:artists=&gt;{:name=&gt;artists.name}, :albums=&gt;{:name=&gt;albums.name, :fourtwo=&gt;42}}
</pre>
<p>
Arguments:
</p>
<ul>
<li>graph_aliases - Should be a hash with keys being symbols of column aliases,
<a href="Dataset.html#M000683">and</a> values being arrays with two <a
href="Dataset.html#M000716">or</a> three elements. The <a
href="Dataset.html#M000660">first</a> element of the array should be the
table alias symbol, <a href="Dataset.html#M000683">and</a> the second
should be the actual column name symbol. If the array has a third element,
it is used <a href="Dataset.html#M000745">as</a> the value returned,
instead of table_alias.column_name.

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000678-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000678-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/graph.rb, line 159</span>
159:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_graph_aliases</span>(<span class="ruby-identifier">graph_aliases</span>)
160:       <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">graph_alias_columns</span>(<span class="ruby-identifier">graph_aliases</span>))
161:       <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:graph_aliases</span>] = <span class="ruby-identifier">graph_aliases</span>
162:       <span class="ruby-identifier">ds</span>
163:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000761" class="method-detail">
        <a name="M000761"></a>

        <div class="method-heading">
          <a href="#M000761" class="method-signature">
          <span class="method-name">set_overrides</span><span class="method-args">(hash)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set values that override hash arguments given to <a
href="Dataset.html#M000754">insert</a> <a
href="Dataset.html#M000683">and</a> <a
href="Dataset.html#M000762">update</a> statements. This hash is merged into
the hash provided to <a href="Dataset.html#M000754">insert</a> <a
href="Dataset.html#M000716">or</a> <a
href="Dataset.html#M000762">update</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000761-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000761-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 242</span>
242:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_overrides</span>(<span class="ruby-identifier">hash</span>)
243:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:overrides=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">hash</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:overrides</span>]<span class="ruby-operator">||</span>{}))
244:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000671" class="method-detail">
        <a name="M000671"></a>

        <div class="method-heading">
          <a href="#M000671" class="method-signature">
          <span class="method-name">single_record</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Dataset.html#M000660">first</a> record in the dataset.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000671-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000671-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 195</span>
195:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">single_record</span>
196:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:limit=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>).<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">r</span>}
197:       <span class="ruby-keyword kw">nil</span>
198:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000672" class="method-detail">
        <a name="M000672"></a>

        <div class="method-heading">
          <a href="#M000672" class="method-signature">
          <span class="method-name">single_value</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Dataset.html#M000660">first</a> value of the <a
href="Dataset.html#M000660">first</a> record in the dataset. Returns nil if
dataset is empty.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000672-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000672-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 202</span>
202:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">single_value</span>
203:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">r</span> = <span class="ruby-identifier">naked</span>.<span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:graph=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">false</span>).<span class="ruby-identifier">single_record</span>
204:         <span class="ruby-identifier">r</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">first</span>
205:       <span class="ruby-keyword kw">end</span>
206:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000733" class="method-detail">
        <a name="M000733"></a>

        <div class="method-heading">
          <a href="#M000733" class="method-signature">
          <span class="method-name">sql</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Same <a href="Dataset.html#M000745">as</a> <a
href="Dataset.html#M000732">select_sql</a>, not aliased directly to make
subclassing simpler.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000733-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000733-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 687</span>
687:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sql</span>
688:       <span class="ruby-identifier">select_sql</span>
689:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000734" class="method-detail">
        <a name="M000734"></a>

        <div class="method-heading">
          <a href="#M000734" class="method-signature">
          <span class="method-name">subscript_sql</span><span class="method-args">(s)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="SQL.html">SQL</a> fragment for specifying subscripts (<a
href="SQL.html">SQL</a> arrays)
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000734-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000734-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 692</span>
692:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">subscript_sql</span>(<span class="ruby-identifier">s</span>)
693:       <span class="ruby-node">&quot;#{literal(s.f)}[#{s.sub.join(COMMA_SEPARATOR)}]&quot;</span>
694:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000673" class="method-detail">
        <a name="M000673"></a>

        <div class="method-heading">
          <a href="#M000673" class="method-signature">
          <span class="method-name">sum</span><span class="method-args">(column)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Dataset.html#M000673">sum</a> for the given column.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000673-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000673-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 209</span>
209:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sum</span>(<span class="ruby-identifier">column</span>)
210:       <span class="ruby-identifier">get</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">sum</span>(<span class="ruby-identifier">column</span>)}
211:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000674" class="method-detail">
        <a name="M000674"></a>

        <div class="method-heading">
          <a href="#M000674" class="method-signature">
          <span class="method-name">table_exists?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if the table <a href="Dataset.html#M000695">exists</a>. Will
raise an error if the dataset has fixed <a href="SQL.html">SQL</a> <a
href="Dataset.html#M000716">or</a> selects <a
href="Dataset.html#M000698">from</a> another dataset <a
href="Dataset.html#M000716">or</a> more than one table.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000674-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000674-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 216</span>
216:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">table_exists?</span>
217:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;this dataset has fixed SQL&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:sql</span>]
218:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;this dataset selects from multiple sources&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">size</span> <span class="ruby-operator">!=</span> <span class="ruby-value">1</span>
219:       <span class="ruby-identifier">t</span> = <span class="ruby-ivar">@opts</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">first</span>
220:       <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-value str">&quot;this dataset selects from a sub query&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Dataset</span>)
221:       <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">table_exists?</span>(<span class="ruby-identifier">t</span>)
222:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000675" class="method-detail">
        <a name="M000675"></a>

        <div class="method-heading">
          <a href="#M000675" class="method-signature">
          <span class="method-name">to_csv</span><span class="method-args">(include_column_titles = true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a string in CSV format containing the dataset records. By default
the CSV representation includes the column titles in the <a
href="Dataset.html#M000660">first</a> line. You can turn that off by
passing false <a href="Dataset.html#M000745">as</a> the
include_column_titles argument.
</p>
<p>
This does not use a CSV library <a href="Dataset.html#M000716">or</a>
handle quoting of values in any way. If any values in any of the rows could
include commas <a href="Dataset.html#M000716">or</a> line endings, you
shouldn&#8216;t use this.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000675-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000675-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 232</span>
232:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_csv</span>(<span class="ruby-identifier">include_column_titles</span> = <span class="ruby-keyword kw">true</span>)
233:       <span class="ruby-identifier">n</span> = <span class="ruby-identifier">naked</span>
234:       <span class="ruby-identifier">cols</span> = <span class="ruby-identifier">n</span>.<span class="ruby-identifier">columns</span>
235:       <span class="ruby-identifier">csv</span> = <span class="ruby-value str">''</span>
236:       <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{cols.join(COMMA_SEPARATOR)}\r\n&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">include_column_titles</span>
237:       <span class="ruby-identifier">n</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{cols.collect{|c| r[c]}.join(COMMA_SEPARATOR)}\r\n&quot;</span>}
238:       <span class="ruby-identifier">csv</span>
239:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000676" class="method-detail">
        <a name="M000676"></a>

        <div class="method-heading">
          <a href="#M000676" class="method-signature">
          <span class="method-name">to_hash</span><span class="method-args">(key_column, value_column = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a hash with one column used <a href="Dataset.html#M000745">as</a>
key <a href="Dataset.html#M000683">and</a> another used <a
href="Dataset.html#M000745">as</a> value. If rows have duplicate values for
the key column, the latter row(s) will overwrite the value of the previous
row(s). If the value_column is not given <a
href="Dataset.html#M000716">or</a> nil, uses the entire hash <a
href="Dataset.html#M000745">as</a> the value.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000676-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000676-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/convenience.rb, line 245</span>
245:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_hash</span>(<span class="ruby-identifier">key_column</span>, <span class="ruby-identifier">value_column</span> = <span class="ruby-keyword kw">nil</span>)
246:       <span class="ruby-identifier">inject</span>({}) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span>, <span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
247:         <span class="ruby-identifier">m</span>[<span class="ruby-identifier">r</span>[<span class="ruby-identifier">key_column</span>]] = <span class="ruby-identifier">value_column</span> <span class="ruby-value">? </span><span class="ruby-identifier">r</span>[<span class="ruby-identifier">value_column</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">r</span>
248:         <span class="ruby-identifier">m</span>
249:       <span class="ruby-keyword kw">end</span>
250:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000735" class="method-detail">
        <a name="M000735"></a>

        <div class="method-heading">
          <a href="#M000735" class="method-signature">
          <span class="method-name">unfiltered</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with no filters (HAVING <a
href="Dataset.html#M000716">or</a> WHERE clause) applied.
</p>
<pre>
  dataset.group(:a).having(:a=&gt;1).where(:b).unfiltered # SELECT * FROM items
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000735-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000735-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 699</span>
699:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unfiltered</span>
700:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:where</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">:having</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>)
701:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000736" class="method-detail">
        <a name="M000736"></a>

        <div class="method-heading">
          <a href="#M000736" class="method-signature">
          <span class="method-name">union</span><span class="method-args">(dataset, all = false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds a UNION clause using a second dataset object. If <a
href="Dataset.html#M000746">all</a> is true the clause used is UNION ALL,
which may return duplicate rows.
</p>
<pre>
  DB[:items].union(DB[:other_items]).sql
  #=&gt; &quot;SELECT * FROM items UNION SELECT * FROM other_items&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000736-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000736-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 708</span>
708:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">union</span>(<span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">all</span> = <span class="ruby-keyword kw">false</span>)
709:       <span class="ruby-identifier">compound_clone</span>(<span class="ruby-identifier">:union</span>, <span class="ruby-identifier">dataset</span>, <span class="ruby-identifier">all</span>)
710:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000737" class="method-detail">
        <a name="M000737"></a>

        <div class="method-heading">
          <a href="#M000737" class="method-signature">
          <span class="method-name">unordered</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with no <a
href="Dataset.html#M000717">order</a>.
</p>
<pre>
  dataset.order(:a).unordered # SELECT * FROM items
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000737-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000737-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 715</span>
715:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unordered</span>
716:       <span class="ruby-identifier">order</span>(<span class="ruby-keyword kw">nil</span>)
717:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000762" class="method-detail">
        <a name="M000762"></a>

        <div class="method-heading">
          <a href="#M000762" class="method-signature">
          <span class="method-name">update</span><span class="method-args">(values={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Updates values for the dataset. The returned value is generally the number
of rows updated, but that is adapter dependent.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000762-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000762-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 248</span>
248:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update</span>(<span class="ruby-identifier">values</span>={})
249:       <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">update_sql</span>(<span class="ruby-identifier">values</span>))
250:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000738" class="method-detail">
        <a name="M000738"></a>

        <div class="method-heading">
          <a href="#M000738" class="method-signature">
          <span class="method-name">update_sql</span><span class="method-args">(values = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Formats an UPDATE statement using the given values.
</p>
<pre>
  dataset.update_sql(:price =&gt; 100, :category =&gt; 'software') #=&gt;
    &quot;UPDATE items SET price = 100, category = 'software'&quot;
</pre>
<p>
Raises an error if the dataset is grouped <a
href="Dataset.html#M000716">or</a> includes more than one table.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000738-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000738-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 726</span>
726:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_sql</span>(<span class="ruby-identifier">values</span> = {})
727:       <span class="ruby-identifier">opts</span> = <span class="ruby-ivar">@opts</span>
728: 
729:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">static_sql</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:sql</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:sql</span>]
730: 
731:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:group</span>]
732:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidOperation</span>, <span class="ruby-value str">&quot;A grouped dataset cannot be updated&quot;</span>
733:       <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:join</span>]
734:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidOperation</span>, <span class="ruby-value str">&quot;A joined dataset cannot be updated&quot;</span>
735:       <span class="ruby-keyword kw">end</span>
736:       
737:       <span class="ruby-identifier">sql</span> = <span class="ruby-node">&quot;UPDATE #{source_list(@opts[:from])} SET &quot;</span>
738:       <span class="ruby-identifier">set</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
739:         <span class="ruby-identifier">values</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:defaults</span>].<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">values</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:defaults</span>]
740:         <span class="ruby-identifier">values</span> = <span class="ruby-identifier">values</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:overrides</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:overrides</span>]
741:         <span class="ruby-comment cmt"># get values from hash</span>
742:         <span class="ruby-identifier">values</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
743:           <span class="ruby-node">&quot;#{[String, Symbol].any?{|c| k.is_a?(c)} ? quote_identifier(k) : literal(k)} = #{literal(v)}&quot;</span>
744:         <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">COMMA_SEPARATOR</span>)
745:       <span class="ruby-keyword kw">else</span>
746:         <span class="ruby-comment cmt"># copy values verbatim</span>
747:         <span class="ruby-identifier">values</span>
748:       <span class="ruby-keyword kw">end</span>
749:       <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">set</span>
750:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">where</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:where</span>]
751:         <span class="ruby-identifier">sql</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; WHERE #{literal(where)}&quot;</span>
752:       <span class="ruby-keyword kw">end</span>
753: 
754:       <span class="ruby-identifier">sql</span>
755:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000739" class="method-detail">
        <a name="M000739"></a>

        <div class="method-heading">
          <a href="#M000739" class="method-signature">
          <span class="method-name">where</span><span class="method-args">(*cond, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add a condition to the WHERE clause. See <a
href="Dataset.html#M000696">filter</a> for argument types.
</p>
<pre>
  dataset.group(:a).having(:a).filter(:b) # SELECT * FROM items GROUP BY a HAVING a AND b
  dataset.group(:a).having(:a).where(:b) # SELECT * FROM items WHERE b GROUP BY a HAVING a
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000739-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000739-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 761</span>
761:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">where</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
762:       <span class="ruby-identifier">_filter</span>(<span class="ruby-identifier">:where</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">cond</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
763:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000740" class="method-detail">
        <a name="M000740"></a>

        <div class="method-heading">
          <a href="#M000740" class="method-signature">
          <span class="method-name">with_sql</span><span class="method-args">(sql, *args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of the dataset with the static <a href="SQL.html">SQL</a>
used. This is useful if you want to keep the same row_proc/graph, but
change the <a href="SQL.html">SQL</a> used to custom <a
href="SQL.html">SQL</a>.
</p>
<pre>
  dataset.with_sql('SELECT * FROM foo') # SELECT * FROM foo
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000740-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000740-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 769</span>
769:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_sql</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
770:       <span class="ruby-identifier">sql</span> = <span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">PlaceholderLiteralString</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">args</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
771:       <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">:sql=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">sql</span>)
772:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Protected Instance methods</h3>

      <div id="method-M000763" class="method-detail">
        <a name="M000763"></a>

        <div class="method-heading">
          <a href="#M000763" class="method-signature">
          <span class="method-name">options_overlap</span><span class="method-args">(opts)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return true if the dataset has a non-nil value for any key in opts.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000763-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000763-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset.rb, line 258</span>
258:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">options_overlap</span>(<span class="ruby-identifier">opts</span>)
259:       <span class="ruby-operator">!</span>(<span class="ruby-ivar">@opts</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span>}.<span class="ruby-identifier">compact</span> <span class="ruby-operator">&amp;</span> <span class="ruby-identifier">opts</span>).<span class="ruby-identifier">empty?</span>
260:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000682" class="method-detail">
        <a name="M000682"></a>

        <div class="method-heading">
          <a href="#M000682" class="method-signature">
          <span class="method-name">to_prepared_statement</span><span class="method-args">(type, values=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return a cloned copy of the current dataset extended with <a
href="Dataset/PreparedStatementMethods.html">PreparedStatementMethods</a>,
setting the type <a href="Dataset.html#M000683">and</a> modify values.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000682-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000682-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/prepared_statements.rb, line 204</span>
204:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_prepared_statement</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">values</span>=<span class="ruby-keyword kw">nil</span>)
205:       <span class="ruby-identifier">ps</span> = <span class="ruby-identifier">clone</span>
206:       <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">PreparedStatementMethods</span>)
207:       <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">prepared_type</span> = <span class="ruby-identifier">type</span>
208:       <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">prepared_modify_values</span> = <span class="ruby-identifier">values</span>
209:       <span class="ruby-identifier">ps</span>
210:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000741" class="method-detail">
        <a name="M000741"></a>

        <div class="method-heading">
          <a href="#M000741" class="method-signature">
          <span class="method-name">to_table_reference</span><span class="method-args">(table_alias=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a table reference for use in the FROM clause. Returns an <a
href="SQL.html">SQL</a> subquery frgament with an optional table alias.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000741-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000741-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/dataset/sql.rb, line 783</span>
783:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_table_reference</span>(<span class="ruby-identifier">table_alias</span>=<span class="ruby-keyword kw">nil</span>)
784:       <span class="ruby-identifier">s</span> = <span class="ruby-node">&quot;(#{sql})&quot;</span>
785:       <span class="ruby-identifier">table_alias</span> <span class="ruby-value">? </span><span class="ruby-identifier">as_sql</span>(<span class="ruby-identifier">s</span>, <span class="ruby-identifier">table_alias</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">s</span>
786:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>