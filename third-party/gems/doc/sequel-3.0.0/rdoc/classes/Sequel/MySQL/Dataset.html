<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Sequel::MySQL::Dataset</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Sequel::MySQL::Dataset</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/sequel/adapters/mysql_rb.html">
                lib/sequel/adapters/mysql.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="../Dataset.html">
                Sequel::Dataset
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
<a href="Dataset.html">Dataset</a> class for <a
href="../MySQL.html">MySQL</a> datasets accessed via the native driver.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000382">call</a>&nbsp;&nbsp;
      <a href="#M000383">delete</a>&nbsp;&nbsp;
      <a href="#M000384">fetch_rows</a>&nbsp;&nbsp;
      <a href="#M000385">insert</a>&nbsp;&nbsp;
      <a href="#M000386">prepare</a>&nbsp;&nbsp;
      <a href="#M000387">replace</a>&nbsp;&nbsp;
      <a href="#M000388">update</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="DatasetMethods.html">Sequel::MySQL::DatasetMethods</a></span>
        <span class="include-name">StoredProcedures</span>
      </div>
    </div>

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Module <a href="Dataset/CallableStatementMethods.html" class="link">Sequel::MySQL::Dataset::CallableStatementMethods</a><br />
Module <a href="Dataset/PreparedStatementMethods.html" class="link">Sequel::MySQL::Dataset::PreparedStatementMethods</a><br />
Module <a href="Dataset/StoredProcedureMethods.html" class="link">Sequel::MySQL::Dataset::StoredProcedureMethods</a><br />

    </div>




      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000382" class="method-detail">
        <a name="M000382"></a>

        <div class="method-heading">
          <a href="#M000382" class="method-signature">
          <span class="method-name">call</span><span class="method-args">(type, bind_arguments={}, values=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="../MySQL.html">MySQL</a> is different in that it supports prepared
statements but not bound variables outside of prepared statements. The
default implementation breaks the use of subselects in prepared statements,
so extend the temporary prepared statement that this creates with a module
that fixes it.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000382-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000382-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/adapters/mysql.rb, line 289</span>
289:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">call</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">bind_arguments</span>={}, <span class="ruby-identifier">values</span>=<span class="ruby-keyword kw">nil</span>)
290:         <span class="ruby-identifier">ps</span> = <span class="ruby-identifier">to_prepared_statement</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">values</span>)
291:         <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">CallableStatementMethods</span>)
292:         <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">bind_arguments</span>)
293:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000383" class="method-detail">
        <a name="M000383"></a>

        <div class="method-heading">
          <a href="#M000383" class="method-signature">
          <span class="method-name">delete</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Delete rows matching this dataset
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000383-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000383-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/adapters/mysql.rb, line 296</span>
296:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete</span>
297:         <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">delete_sql</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">affected_rows</span>}
298:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000384" class="method-detail">
        <a name="M000384"></a>

        <div class="method-heading">
          <a href="#M000384" class="method-signature">
          <span class="method-name">fetch_rows</span><span class="method-args">(sql) {|h| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Yield all rows matching this dataset
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000384-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000384-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/adapters/mysql.rb, line 301</span>
301:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fetch_rows</span>(<span class="ruby-identifier">sql</span>)
302:         <span class="ruby-identifier">execute</span>(<span class="ruby-identifier">sql</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
303:           <span class="ruby-identifier">column_types</span> = []
304:           <span class="ruby-ivar">@columns</span> = <span class="ruby-identifier">r</span>.<span class="ruby-identifier">fetch_fields</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">column_types</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">type</span>; <span class="ruby-identifier">output_identifier</span>(<span class="ruby-identifier">f</span>.<span class="ruby-identifier">name</span>)}
305:           <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">row</span> = <span class="ruby-identifier">r</span>.<span class="ruby-identifier">fetch_row</span>
306:             <span class="ruby-identifier">h</span> = {}
307:             <span class="ruby-ivar">@columns</span>.<span class="ruby-identifier">each_with_index</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">f</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">f</span>] = <span class="ruby-identifier">convert_type</span>(<span class="ruby-identifier">row</span>[<span class="ruby-identifier">i</span>], <span class="ruby-identifier">column_types</span>[<span class="ruby-identifier">i</span>])}
308:             <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">h</span>
309:           <span class="ruby-keyword kw">end</span>
310:         <span class="ruby-keyword kw">end</span>
311:         <span class="ruby-keyword kw">self</span>
312:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000385" class="method-detail">
        <a name="M000385"></a>

        <div class="method-heading">
          <a href="#M000385" class="method-signature">
          <span class="method-name">insert</span><span class="method-args">(*values)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Insert a new value into this dataset
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000385-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000385-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/adapters/mysql.rb, line 315</span>
315:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">insert</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">values</span>)
316:         <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">insert_sql</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">values</span>)){<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">insert_id</span>}
317:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000386" class="method-detail">
        <a name="M000386"></a>

        <div class="method-heading">
          <a href="#M000386" class="method-signature">
          <span class="method-name">prepare</span><span class="method-args">(type, name=nil, values=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Store the given type of prepared statement in the associated database with
the given name.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000386-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000386-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/adapters/mysql.rb, line 321</span>
321:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prepare</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">name</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">values</span>=<span class="ruby-keyword kw">nil</span>)
322:         <span class="ruby-identifier">ps</span> = <span class="ruby-identifier">to_prepared_statement</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">values</span>)
323:         <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">PreparedStatementMethods</span>)
324:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>
325:           <span class="ruby-identifier">ps</span>.<span class="ruby-identifier">prepared_statement_name</span> = <span class="ruby-identifier">name</span>
326:           <span class="ruby-identifier">db</span>.<span class="ruby-identifier">prepared_statements</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">ps</span>
327:         <span class="ruby-keyword kw">end</span>
328:         <span class="ruby-identifier">ps</span>
329:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000387" class="method-detail">
        <a name="M000387"></a>

        <div class="method-heading">
          <a href="#M000387" class="method-signature">
          <span class="method-name">replace</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Replace (<a href="Dataset.html#M000388">update</a> or <a
href="Dataset.html#M000385">insert</a>) the matching row.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000387-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000387-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/adapters/mysql.rb, line 332</span>
332:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">replace</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
333:         <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">replace_sql</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)){<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">insert_id</span>}
334:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000388" class="method-detail">
        <a name="M000388"></a>

        <div class="method-heading">
          <a href="#M000388" class="method-signature">
          <span class="method-name">update</span><span class="method-args">(values={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Update the matching rows.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000388-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000388-source">
<pre>
     <span class="ruby-comment cmt"># File lib/sequel/adapters/mysql.rb, line 337</span>
337:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update</span>(<span class="ruby-identifier">values</span>={})
338:         <span class="ruby-identifier">execute_dui</span>(<span class="ruby-identifier">update_sql</span>(<span class="ruby-identifier">values</span>)){<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">affected_rows</span>}
339:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>