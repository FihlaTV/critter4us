<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: 1.3.txt</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>1.3.txt</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>doc/release_notes/1.3.txt
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Sat Jul 25 16:28:14 -0500 2009</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h3>Better model associations</h3>
<p>
The latest release of sequel_model includes a new associations
functionality written by Jeremy Evans which replaces the old relations code
in previous versions. Please note that this version is not completely
backward-compatible and you should therefore upgrade with caution.
</p>
<p>
The new implementation supports three kinds of relations: one_to_many,
many_to_one and many_to_many, which correspond to has_many, belongs_to and
has_and_belongs_to_many relations in ActiveRecord. In fact, the new
implementation includes aliases for ActiveRecord assocation macros and is
basically compatible with ActiveRecord conventions. It also supports DRY
implicit class name references. Here&#8216;s a simple example:
</p>
<pre>
  class Author &lt; Sequel::Model
    has_many :books # equivalent to one_to_many
  end

  class Book &lt; Sequel::Model
    belongs_to :author # equivalent to many_to_one
    has_and_belongs_to_many :categories # equivalent to many_to_many
  end

  class Category &lt; Sequel::Model
    has_and_belongs_to_many :books
  end
</pre>
<p>
These macros will create the following methods:
</p>
<ul>
<li>Author#books, Author#add_book, Author#remove_book

</li>
<li>Book#author, Book#categories, Book#add_category,

</li>
</ul>
<p>
Book#remove_category
</p>
<ul>
<li>Category#books, Category#add_book, Category#remove_book

</li>
</ul>
<p>
Unlike ActiveRecord, one_to_many and many_to_many association methods
return a dataset:
</p>
<pre>
  a = Author[1234]
  a.books.sql #=&gt; 'SELECT * FROM books WHERE (author_id = 1234)'
</pre>
<p>
You can also tell <a href="../../../classes/Sequel.html">Sequel</a> to
cache the association result set and return it as an array:
</p>
<pre>
  class Author &lt; Sequel::Model
    has_many :books, :cache =&gt; true
  end

  Author[1234].books.class #=&gt; Array
</pre>
<p>
You can of course bypass the defaults and specify class names and key
names:
</p>
<pre>
  class Node &lt; Sequel::Model
    belongs_to :parent, :class =&gt; Node
    belongs_to :session, :key =&gt; :producer_id
  end
</pre>
<p>
Another useful option is :order, which sets the order for the association
dataset:
</p>
<pre>
  class Author &lt; Sequel::Model
    has_many :books, :order =&gt; :title
  end

  Author[1234].books.sql #=&gt; 'SELECT * FROM books WHERE (author_id =
</pre>
<p>
1234) ORDER BY title&#8216;
</p>
<p>
More information about associations can be found in the <a
href="../../../classes/Sequel.html">Sequel</a> documentation.
</p>
<h3>Other changes</h3>
<ul>
<li>Added configuration file for running specs (186).

</li>
<li>Changed Database#drop_index to accept fixed arity (173).

</li>
<li>Changed column definition sql to put UNSIGNED constraint before

</li>
</ul>
<p>
unique in order to satisfy MySQL (171).
</p>
<ul>
<li>Enhanced MySQL adapter to support load data local infile_, added

</li>
</ul>
<p>
compress option for mysql connection by default (172).
</p>
<ul>
<li>Fixed bug when inserting hashes in array tuples mode.

</li>
<li>Changed SQLite adapter to catch RuntimeError raised when executing a

</li>
</ul>
<p>
statement and raise Error::InvalidStatement with the offending SQL and
error message (188).
</p>
<ul>
<li>Fixed Dataset#reverse to not raise for unordered dataset (189).

</li>
<li>Added Dataset#unordered method and changed order to remove order if

</li>
</ul>
<p>
nil is specified (190).
</p>
<ul>
<li>Fixed reversing order of ASC expression (164).

</li>
<li>Added support for :null =&gt; true option when defining table columns

</li>
</ul>
<p>
(192).
</p>
<ul>
<li>Fixed Symbol#method_missing to accept variable arity (185).

</li>
</ul>

    </div>


   </div>


  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>