<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: schema.rdoc</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>schema.rdoc</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>doc/schema.rdoc
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Sat Jul 25 16:28:14 -0500 2009</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h1>Schema Modifications with <a href="../../classes/Sequel.html">Sequel</a></h1>
<p>
In addition to its support for getting data from databases, <a
href="../../classes/Sequel.html">Sequel</a> has good support for modifying
the schema of databases. Unfortunately, the documentation from this is
spread out in various places in the <a
href="../../classes/Sequel.html">Sequel</a> RDoc.
</p>
<p>
The recommended way to set up schema modifications in <a
href="../../classes/Sequel.html">Sequel</a> is through migrations.
Migrations are modifications to the schema that handle modifying the schema
in two directions, up and down, with down reversing the changes made by up.
Migrations are stored in sequentially numbered files inside a directory
(see the <a href="../../classes/Sequel/Migrator.html">Sequel::Migrator</a>
documentation for file naming format details). The migrations can be run on
the database using the sequel command line tool (the -m and -M switches).
</p>
<p>
The format of the individual migration files themselves is explained in the
<a href="../../classes/Sequel/Migration.html">Sequel::Migration</a>
documentation. Each migration file contains a single migration class. The
migration class acts a proxy for the related database (given on the command
line if the sequel command line tool is used, or by the db argument to
Sequel::Migration#apply if the API is used). The methods that can be used
inside Sequel::Migration#up or Sequel::Migration#down are just <a
href="../../classes/Sequel/Database.html">Sequel::Database</a> instance
methods, such as create_table, drop_table, and alter_table. Most database
methods that alter the schema take regular arguments, but create_table and
alter_table take a block. The methods you can use inside the create_table
block are documented in <a
href="../../classes/Sequel/Schema/Generator.html">Sequel::Schema::Generator</a>,
and the methods you can use inside the alter_table block are documented in
<a
href="../../classes/Sequel/Schema/AlterTableGenerator.html">Sequel::Schema::AlterTableGenerator</a>.
</p>
<p>
Migrations are not required, you can just call the schema modification
methods directly on the database object. This is often done in test code
and examples. However, it is recommended that you use the migration
framework unless the database schema will not be changing in the future, as
it provides a way to easily handle modifications to existing database
schema.
</p>
<p>
<a href="../../classes/Sequel.html">Sequel</a> has the ability to have
database independent migrations using ruby classes as types. When you use a
ruby class as a type, <a href="../../classes/Sequel.html">Sequel</a>
translates it to the most comparable type in the database you are using.
Here&#8216;s an example using all supported types:
</p>
<pre>
    DB.create_table(:cats) do
      primary_key :id, :type=&gt;Integer # integer
      String :a                       # varchar(255)
      column :b, File                 # blob
      Fixnum :c                       # integer
      foreign_key :d, :other_table, :type=&gt;Bignum # bigint
      Float :e                        # double precision
      BigDecimal :f                   # numeric
      Date :g                         # date
      DateTime :h                     # timestamp
      Time :i                         # timestamp
      Numeric :j                      # numeric
      TrueClass :k                    # boolean
      FalseClass :l                   # boolean
    end
</pre>
<p>
Basically, if you use one of the ruby classes above, it will translate into
a database specific type. If you use a lowercase method, symbol, or string
to specify the type, <a href="../../classes/Sequel.html">Sequel</a>
won&#8216;t attempt to translate it.
</p>
<p>
Note that if you use a ruby class, you shouldn&#8216;t use a :size option.
Using a ruby class means that you want <a
href="../../classes/Sequel.html">Sequel</a> to pick the database type to
use. If you want to specify the size, you are no longer in database
independent territory, and you need to specify the type as well, using a
lowercase method, symbol, or string.
</p>

    </div>


   </div>


  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>